
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Get-WinEvent.forpdfconversion/">
      
      
        <link rel="next" href="../PowerShell.forpdfconversion/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.1">
    
    
      
        <title>Logstash - UWF CCDC</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#logstash" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="UWF CCDC" class="md-header__button md-logo" aria-label="UWF CCDC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            UWF CCDC
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Logstash
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/bkemily/UWFCCDC.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="UWF CCDC" class="md-nav__button md-logo" aria-label="UWF CCDC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    UWF CCDC
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bkemily/UWFCCDC.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UWFCCDC
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Firewall
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Firewall
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Firewall/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UWFCCDC
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Linux
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Linux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UWFCCDC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/LinuxCLI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux Command Line Cheat Sheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/LinuxCLI101/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux 101 Command Line Cheat Sheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/Logstash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logstash
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/integrity-checks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integrity checking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/package-managers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Package manager tricks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CCDC 2020 Linux BASH
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            CCDC 2020 Linux BASH
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/CCDC%202020%20Linux%20BASH/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cyberpatriot
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Nessus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nessus
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/curl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    curl
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/ngrep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ngrep
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/tcpdump/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tcpdump
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Windows
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Windows
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UWFCCDC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Get-WinEvent.forpdfconversion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get-WinEvent PowerShell cmdlet Cheat Sheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Logstash
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Logstash
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    <span class="md-ellipsis">
      Abstract
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-to-acquire" class="md-nav__link">
    <span class="md-ellipsis">
      Where to Acquire
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examplesuse-case" class="md-nav__link">
    <span class="md-ellipsis">
      Examples/Use Case
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#general-knowledge" class="md-nav__link">
    <span class="md-ellipsis">
      General Knowledge
    </span>
  </a>
  
    <nav class="md-nav" aria-label="General Knowledge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#type" class="md-nav__link">
    <span class="md-ellipsis">
      type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tags" class="md-nav__link">
    <span class="md-ellipsis">
      tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logic" class="md-nav__link">
    <span class="md-ellipsis">
      logic
    </span>
  </a>
  
    <nav class="md-nav" aria-label="logic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#conditions-dealing-with-numbers" class="md-nav__link">
    <span class="md-ellipsis">
      Conditions dealing with Numbers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conditions-dealing-with-strings" class="md-nav__link">
    <span class="md-ellipsis">
      Conditions dealing with Strings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#condition-checks-against-a-fields-existance" class="md-nav__link">
    <span class="md-ellipsis">
      Condition checks against a field's existance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-multiple-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      Handling multiple conditions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-plugins" class="md-nav__link">
    <span class="md-ellipsis">
      Input Plugins
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Input Plugins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#beats" class="md-nav__link">
    <span class="md-ellipsis">
      beats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elasticsearch" class="md-nav__link">
    <span class="md-ellipsis">
      elasticsearch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jdbc" class="md-nav__link">
    <span class="md-ellipsis">
      jdbc
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-jdbc-jdbc_driver_library-etclogstashdriverssqljdbc42jar-jdbc_driver_class-commicrosoftsqlserverjdbcsqlserverdriver-jdbc_connection_string-jdbcsqlserversqlserver_name_goes_here1433databasenamedatabase_name_goes_here-jdbc_fetch_size-10000-jdbc_user-sql_user_goes_here-jdbc_password-sql_password_goes_here-schedule-statement-select-idipv4usermesesage-from-logs-tracking_column-id-type-mssql" class="md-nav__link">
    <span class="md-ellipsis">
      input { jdbc { jdbc_driver_library =&gt; &quot;/etc/logstash/drivers/sqljdbc42.jar&quot; jdbc_driver_class =&gt; &quot;com.microsoft.sqlserver.jdbc.SQLServerDriver&quot; jdbc_connection_string =&gt; &quot;jdbc:sqlserver://sqlserver_name_goes_here:1433;databasename=database_name_goes_here&quot; jdbc_fetch_size =&gt; &quot;10000&quot; jdbc_user =&gt; &quot;sql_user_goes_here&quot; jdbc_password =&gt; &quot;sql_password_goes_here&quot; schedule =&gt; &quot;* * * * *&quot; statement =&gt; &quot;SELECT id,ipv4,user,mesesage FROM logs&quot; tracking_column =&gt; id type =&gt; &quot;mssql&quot; } }
    </span>
  </a>
  
    <nav class="md-nav" aria-label="input { jdbc { jdbc_driver_library => "/etc/logstash/drivers/sqljdbc42.jar" jdbc_driver_class => "com.microsoft.sqlserver.jdbc.SQLServerDriver" jdbc_connection_string => "jdbc:sqlserver://sqlserver_name_goes_here:1433;databasename=database_name_goes_here" jdbc_fetch_size => "10000" jdbc_user => "sql_user_goes_here" jdbc_password => "sql_password_goes_here" schedule => "* * * * *" statement => "SELECT id,ipv4,user,mesesage FROM logs" tracking_column => id type => "mssql" } }">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file" class="md-nav__link">
    <span class="md-ellipsis">
      file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp" class="md-nav__link">
    <span class="md-ellipsis">
      tcp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#udp" class="md-nav__link">
    <span class="md-ellipsis">
      udp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rabbitmq" class="md-nav__link">
    <span class="md-ellipsis">
      rabbitmq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kafka" class="md-nav__link">
    <span class="md-ellipsis">
      kafka
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codecs" class="md-nav__link">
    <span class="md-ellipsis">
      codecs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filter-parsing-plugins" class="md-nav__link">
    <span class="md-ellipsis">
      Filter Parsing Plugins
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Filter Parsing Plugins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#csv" class="md-nav__link">
    <span class="md-ellipsis">
      csv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#date" class="md-nav__link">
    <span class="md-ellipsis">
      date
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grok" class="md-nav__link">
    <span class="md-ellipsis">
      grok
    </span>
  </a>
  
    <nav class="md-nav" aria-label="grok">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multiple-grok-match" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple grok match
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-optional-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Handling optional fields
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json" class="md-nav__link">
    <span class="md-ellipsis">
      json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kv" class="md-nav__link">
    <span class="md-ellipsis">
      kv
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filter-enrichment-plugins" class="md-nav__link">
    <span class="md-ellipsis">
      Filter Enrichment Plugins
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Filter Enrichment Plugins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dns" class="md-nav__link">
    <span class="md-ellipsis">
      dns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drop" class="md-nav__link">
    <span class="md-ellipsis">
      drop
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter_elasticsearch" class="md-nav__link">
    <span class="md-ellipsis">
      filter_elasticsearch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memoize" class="md-nav__link">
    <span class="md-ellipsis">
      memoize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="memoize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#other-use-cases-for-the-memoize-filter-plugin" class="md-nav__link">
    <span class="md-ellipsis">
      Other use cases for the memoize filter plugin:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geoip" class="md-nav__link">
    <span class="md-ellipsis">
      geoip
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mutate" class="md-nav__link">
    <span class="md-ellipsis">
      mutate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mutate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-a-field" class="md-nav__link">
    <span class="md-ellipsis">
      Add a field
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-a-tag" class="md-nav__link">
    <span class="md-ellipsis">
      Add a tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-a-field-type-integer-float-string-boolean" class="md-nav__link">
    <span class="md-ellipsis">
      Convert a field type (integer, float, string, boolean)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-replacement-gsub" class="md-nav__link">
    <span class="md-ellipsis">
      String Replacement (gsub)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-unique-id" class="md-nav__link">
    <span class="md-ellipsis">
      Add unique ID
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lowercase-all-text" class="md-nav__link">
    <span class="md-ellipsis">
      lowercase all text
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-unwantedredundant-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Remove unwanted/redundant field(s)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-tags" class="md-nav__link">
    <span class="md-ellipsis">
      Remove tag(s)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rename-standardize-field-names" class="md-nav__link">
    <span class="md-ellipsis">
      Rename / Standardize field name(s)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replace-a-fields-value" class="md-nav__link">
    <span class="md-ellipsis">
      Replace a field's value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-whitespace-from-beginning-and-end-of-field" class="md-nav__link">
    <span class="md-ellipsis">
      Remove whitespace from beginning and end of field
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uppercase-all-text" class="md-nav__link">
    <span class="md-ellipsis">
      uppercase all text
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rest" class="md-nav__link">
    <span class="md-ellipsis">
      rest
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recommended-use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Recommended use cases:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ruby" class="md-nav__link">
    <span class="md-ellipsis">
      ruby
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ruby">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recommended-use-cases_1" class="md-nav__link">
    <span class="md-ellipsis">
      Recommended use cases:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#syslog_pri" class="md-nav__link">
    <span class="md-ellipsis">
      syslog_pri
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tld" class="md-nav__link">
    <span class="md-ellipsis">
      tld
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#translate" class="md-nav__link">
    <span class="md-ellipsis">
      translate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-plugins" class="md-nav__link">
    <span class="md-ellipsis">
      Output Plugins
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Output Plugins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stdout" class="md-nav__link">
    <span class="md-ellipsis">
      stdout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_elasticsearch" class="md-nav__link">
    <span class="md-ellipsis">
      output_elasticsearch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_file" class="md-nav__link">
    <span class="md-ellipsis">
      output_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_rabbitmq" class="md-nav__link">
    <span class="md-ellipsis">
      output_rabbitmq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_kafka" class="md-nav__link">
    <span class="md-ellipsis">
      output_kafka
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_tcp" class="md-nav__link">
    <span class="md-ellipsis">
      output_tcp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_udp" class="md-nav__link">
    <span class="md-ellipsis">
      output_udp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-info" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Info
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PowerShell.forpdfconversion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SANS PowerShell Cheat Sheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../WindowsEventLogsTable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Some Key Windows Event Logs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    <span class="md-ellipsis">
      Abstract
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-to-acquire" class="md-nav__link">
    <span class="md-ellipsis">
      Where to Acquire
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examplesuse-case" class="md-nav__link">
    <span class="md-ellipsis">
      Examples/Use Case
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#general-knowledge" class="md-nav__link">
    <span class="md-ellipsis">
      General Knowledge
    </span>
  </a>
  
    <nav class="md-nav" aria-label="General Knowledge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#type" class="md-nav__link">
    <span class="md-ellipsis">
      type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tags" class="md-nav__link">
    <span class="md-ellipsis">
      tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logic" class="md-nav__link">
    <span class="md-ellipsis">
      logic
    </span>
  </a>
  
    <nav class="md-nav" aria-label="logic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#conditions-dealing-with-numbers" class="md-nav__link">
    <span class="md-ellipsis">
      Conditions dealing with Numbers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conditions-dealing-with-strings" class="md-nav__link">
    <span class="md-ellipsis">
      Conditions dealing with Strings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#condition-checks-against-a-fields-existance" class="md-nav__link">
    <span class="md-ellipsis">
      Condition checks against a field's existance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-multiple-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      Handling multiple conditions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-plugins" class="md-nav__link">
    <span class="md-ellipsis">
      Input Plugins
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Input Plugins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#beats" class="md-nav__link">
    <span class="md-ellipsis">
      beats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elasticsearch" class="md-nav__link">
    <span class="md-ellipsis">
      elasticsearch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jdbc" class="md-nav__link">
    <span class="md-ellipsis">
      jdbc
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-jdbc-jdbc_driver_library-etclogstashdriverssqljdbc42jar-jdbc_driver_class-commicrosoftsqlserverjdbcsqlserverdriver-jdbc_connection_string-jdbcsqlserversqlserver_name_goes_here1433databasenamedatabase_name_goes_here-jdbc_fetch_size-10000-jdbc_user-sql_user_goes_here-jdbc_password-sql_password_goes_here-schedule-statement-select-idipv4usermesesage-from-logs-tracking_column-id-type-mssql" class="md-nav__link">
    <span class="md-ellipsis">
      input { jdbc { jdbc_driver_library =&gt; &quot;/etc/logstash/drivers/sqljdbc42.jar&quot; jdbc_driver_class =&gt; &quot;com.microsoft.sqlserver.jdbc.SQLServerDriver&quot; jdbc_connection_string =&gt; &quot;jdbc:sqlserver://sqlserver_name_goes_here:1433;databasename=database_name_goes_here&quot; jdbc_fetch_size =&gt; &quot;10000&quot; jdbc_user =&gt; &quot;sql_user_goes_here&quot; jdbc_password =&gt; &quot;sql_password_goes_here&quot; schedule =&gt; &quot;* * * * *&quot; statement =&gt; &quot;SELECT id,ipv4,user,mesesage FROM logs&quot; tracking_column =&gt; id type =&gt; &quot;mssql&quot; } }
    </span>
  </a>
  
    <nav class="md-nav" aria-label="input { jdbc { jdbc_driver_library => "/etc/logstash/drivers/sqljdbc42.jar" jdbc_driver_class => "com.microsoft.sqlserver.jdbc.SQLServerDriver" jdbc_connection_string => "jdbc:sqlserver://sqlserver_name_goes_here:1433;databasename=database_name_goes_here" jdbc_fetch_size => "10000" jdbc_user => "sql_user_goes_here" jdbc_password => "sql_password_goes_here" schedule => "* * * * *" statement => "SELECT id,ipv4,user,mesesage FROM logs" tracking_column => id type => "mssql" } }">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file" class="md-nav__link">
    <span class="md-ellipsis">
      file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp" class="md-nav__link">
    <span class="md-ellipsis">
      tcp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#udp" class="md-nav__link">
    <span class="md-ellipsis">
      udp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rabbitmq" class="md-nav__link">
    <span class="md-ellipsis">
      rabbitmq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kafka" class="md-nav__link">
    <span class="md-ellipsis">
      kafka
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codecs" class="md-nav__link">
    <span class="md-ellipsis">
      codecs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filter-parsing-plugins" class="md-nav__link">
    <span class="md-ellipsis">
      Filter Parsing Plugins
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Filter Parsing Plugins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#csv" class="md-nav__link">
    <span class="md-ellipsis">
      csv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#date" class="md-nav__link">
    <span class="md-ellipsis">
      date
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grok" class="md-nav__link">
    <span class="md-ellipsis">
      grok
    </span>
  </a>
  
    <nav class="md-nav" aria-label="grok">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multiple-grok-match" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple grok match
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-optional-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Handling optional fields
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json" class="md-nav__link">
    <span class="md-ellipsis">
      json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kv" class="md-nav__link">
    <span class="md-ellipsis">
      kv
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filter-enrichment-plugins" class="md-nav__link">
    <span class="md-ellipsis">
      Filter Enrichment Plugins
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Filter Enrichment Plugins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dns" class="md-nav__link">
    <span class="md-ellipsis">
      dns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drop" class="md-nav__link">
    <span class="md-ellipsis">
      drop
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter_elasticsearch" class="md-nav__link">
    <span class="md-ellipsis">
      filter_elasticsearch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memoize" class="md-nav__link">
    <span class="md-ellipsis">
      memoize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="memoize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#other-use-cases-for-the-memoize-filter-plugin" class="md-nav__link">
    <span class="md-ellipsis">
      Other use cases for the memoize filter plugin:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geoip" class="md-nav__link">
    <span class="md-ellipsis">
      geoip
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mutate" class="md-nav__link">
    <span class="md-ellipsis">
      mutate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mutate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-a-field" class="md-nav__link">
    <span class="md-ellipsis">
      Add a field
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-a-tag" class="md-nav__link">
    <span class="md-ellipsis">
      Add a tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-a-field-type-integer-float-string-boolean" class="md-nav__link">
    <span class="md-ellipsis">
      Convert a field type (integer, float, string, boolean)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string-replacement-gsub" class="md-nav__link">
    <span class="md-ellipsis">
      String Replacement (gsub)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-unique-id" class="md-nav__link">
    <span class="md-ellipsis">
      Add unique ID
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lowercase-all-text" class="md-nav__link">
    <span class="md-ellipsis">
      lowercase all text
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-unwantedredundant-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Remove unwanted/redundant field(s)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-tags" class="md-nav__link">
    <span class="md-ellipsis">
      Remove tag(s)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rename-standardize-field-names" class="md-nav__link">
    <span class="md-ellipsis">
      Rename / Standardize field name(s)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replace-a-fields-value" class="md-nav__link">
    <span class="md-ellipsis">
      Replace a field's value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-whitespace-from-beginning-and-end-of-field" class="md-nav__link">
    <span class="md-ellipsis">
      Remove whitespace from beginning and end of field
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uppercase-all-text" class="md-nav__link">
    <span class="md-ellipsis">
      uppercase all text
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rest" class="md-nav__link">
    <span class="md-ellipsis">
      rest
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recommended-use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Recommended use cases:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ruby" class="md-nav__link">
    <span class="md-ellipsis">
      ruby
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ruby">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recommended-use-cases_1" class="md-nav__link">
    <span class="md-ellipsis">
      Recommended use cases:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#syslog_pri" class="md-nav__link">
    <span class="md-ellipsis">
      syslog_pri
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tld" class="md-nav__link">
    <span class="md-ellipsis">
      tld
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#translate" class="md-nav__link">
    <span class="md-ellipsis">
      translate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-plugins" class="md-nav__link">
    <span class="md-ellipsis">
      Output Plugins
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Output Plugins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stdout" class="md-nav__link">
    <span class="md-ellipsis">
      stdout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_elasticsearch" class="md-nav__link">
    <span class="md-ellipsis">
      output_elasticsearch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_file" class="md-nav__link">
    <span class="md-ellipsis">
      output_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_rabbitmq" class="md-nav__link">
    <span class="md-ellipsis">
      output_rabbitmq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_kafka" class="md-nav__link">
    <span class="md-ellipsis">
      output_kafka
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_tcp" class="md-nav__link">
    <span class="md-ellipsis">
      output_tcp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_udp" class="md-nav__link">
    <span class="md-ellipsis">
      output_udp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-info" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Info
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="logstash">Logstash</h1>
<h2 id="abstract">Abstract</h2>
<p>Logstash is a log aggregator designed to collect, parse, and enrich logs. It is a major open source component of the Elastic Stack. It can be used in conjunction with other commerial SIEM solutions.</p>
<h2 id="where-to-acquire">Where to Acquire</h2>
<p>Logstash can be downloaded from https://www.elastic.co/products/logstash. It is open source but also has a commercial support offering.</p>
<h2 id="examplesuse-case">Examples/Use Case</h2>
<p>Below are some of the common configurations used with Logstash.</p>
<h2 id="general-knowledge">General Knowledge</h2>
<ul>
<li><a href="#type">type</a></li>
<li><a href="#tags">tags</a></li>
<li><a href="#logic">conditional logic</a> - If statements</li>
</ul>
<!-- - [architecture](#architecture) -->

<hr />
<h3 id="type">type</h3>
<p>The <strong>type</strong> field is a special field often used to control how logs are handled. It can be used to control how a log is parsed and ultimately stored.</p>
<p>Type is most commonly set within an input plugin. For example, this configuration would set the type to windows anytime logs come in over TCP port 6052:
<div class="highlight"><pre><span></span><code>input<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>tcp<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nv">port</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="m">6052</span>
<span class="w">        </span><span class="nb">type</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;windows&quot;</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
This type could then be used to conditionally interact with logs with a type of "windows":</p>
<div class="highlight"><pre><span></span><code>filter<span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[</span>type<span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;windows&quot;</span><span class="w"> </span><span class="o">{</span>
<span class="w">      </span><span class="k">do</span><span class="w"> </span>something...
<span class="w">  </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>It can also be used to control where the logs ultimately are saved such as an Elasticsearch index of logstash-windows-2017-06-10:
<div class="highlight"><pre><span></span><code>output<span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span>type<span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;windows&quot;</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span>elasticsearch<span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="nv">index</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;logstash-windows-%{+YYYY.MM.dd}&quot;</span>
<span class="w">        </span><span class="o">}</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div></p>
<hr />
<h3 id="tags">tags</h3>
<p>Tags are attributes used to apply conditional filtering or to ease searching. It also can be used to route logs to their final destination. A log can have an unlimited amount of tags.</p>
<p>Tags can be set at input but can also be applied within the filter section. Below is an example of setting a tag of "windows" for any logs coming in over port 6052:
<div class="highlight"><pre><span></span><code>input<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>tcp<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nv">port</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="m">6052</span>
<span class="w">        </span><span class="nv">tags</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;windows&quot;</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
Below is an example of adding a tag within the filter portion of Logstash:</p>
<div class="highlight"><pre><span></span><code>filter<span class="w"> </span><span class="o">{</span>
<span class="w">  </span>mutate<span class="w"> </span><span class="o">{</span>
<span class="w">      </span><span class="nv">add_tag</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;windows&quot;</span>
<span class="w">  </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>Below is an example of adding multiple tags within the filter portion of Logstash:</p>
<div class="highlight"><pre><span></span><code>filter<span class="w"> </span><span class="o">{</span>
<span class="w">  </span>mutate<span class="w"> </span><span class="o">{</span>
<span class="w">      </span><span class="nv">add_tag</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;windows&quot;</span>,<span class="w"> </span><span class="s2">&quot;pci&quot;</span>,<span class="w"> </span><span class="s2">&quot;critical_asset&quot;</span><span class="w"> </span><span class="o">]</span>
<span class="w">  </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>Tags can be used to control where the logs ultimately are saved such as an Elasticsearch index of logstash-windows-2017-06-10:
<div class="highlight"><pre><span></span><code>output<span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="s2">&quot;windows&quot;</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">[</span>tags<span class="o">]</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span>elasticsearch<span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="nv">index</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;logstash-windows-%{+YYYY.MM.dd}&quot;</span>
<span class="w">        </span><span class="o">}</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div></p>
<p>Tags can greatly aid in searching and detection techniques. This can be used so that an analyst can quickly search for whether a connection is outbound to the internet or to an internal system. It also can be used to apply log enrichment to select logs. </p>
<p>For example, below is an example of tagging IP addresses. 
<div class="highlight"><pre><span></span><code>filter<span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[</span>destination_ip<span class="o">]</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span><span class="s2">&quot;2(?:2[4-9]|3\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d?|0)){3}&quot;</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>mutate<span class="w"> </span><span class="o">{</span>
<span class="w">      </span><span class="nv">add_tag</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;multicast&quot;</span><span class="w"> </span><span class="o">]</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">  </span><span class="o">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[</span>destination_ip<span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;255.255.255.255&quot;</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>mutate<span class="w"> </span><span class="o">{</span>
<span class="w">      </span><span class="nv">add_tag</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;broadcast&quot;</span><span class="w"> </span><span class="o">]</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">  </span><span class="o">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[</span>destination_ip<span class="o">]</span><span class="w"> </span>and<span class="w"> </span><span class="s2">&quot;multicast&quot;</span><span class="w"> </span>not<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">[</span>tags<span class="o">]</span><span class="w"> </span>and<span class="w"> </span><span class="s2">&quot;broadcast&quot;</span><span class="w"> </span>not<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">[</span>tags<span class="o">]</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span>destination_ip<span class="o">]</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span><span class="s2">&quot;10\.&quot;</span><span class="w"> </span>or<span class="w"> </span><span class="o">[</span>destination_ip<span class="o">]</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span><span class="s2">&quot;192\.168\.&quot;</span><span class="w"> </span>or<span class="w"> </span><span class="o">[</span>destination_ip<span class="o">]</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span><span class="s2">&quot;172\.(1[6-9]|2[0-9]|3[0-1])\.&quot;</span><span class="w"> </span><span class="o">{</span>
<span class="w">      </span>mutate<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nv">add_tag</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;internal_destination&quot;</span><span class="w"> </span><span class="o">]</span>
<span class="w">      </span><span class="o">}</span>
<span class="w">    </span><span class="o">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="o">{</span>
<span class="w">      </span>mutate<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nv">add_tag</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;external_destination&quot;</span><span class="w"> </span><span class="o">]</span>
<span class="w">      </span><span class="o">}</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">  </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div></p>
<hr />
<h3 id="logic">logic</h3>
<p>Conditional logic is required to properly scale and use Logstash in an enterprise environment. It allows you to accept, parse, or enrich logs based on specific conditions.</p>
<p>A simple condition would be to do something <strong>IF</strong> a value equals something specific. Example:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">field</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;7&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">do_something</span><span class="p">...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="conditions-dealing-with-numbers">Conditions dealing with Numbers</h4>
<p><strong>Note:</strong> That "7" is not the same as 7. <strong>"7"</strong> means the string of 7 and <strong>7</strong> means an integer of 7. If the field contained the integer 7 you would need to do this:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">field</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">7</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">do_something</span><span class="p">...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>If a field contains a number value than you can use greater than or less than. Examples:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">field</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">7</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">do_something</span><span class="p">...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">field</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">7</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">do_something</span><span class="p">...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>You can also do less than or equal to and greater than or equal to. Example:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">field</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">7</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">do_something</span><span class="p">...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="conditions-dealing-with-strings">Conditions dealing with Strings</h4>
<p>When checking against a string you can do an exact match such as follows:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">field</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">do_something</span><span class="p">...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Or you can do a regex match such as below. The <strong>=~</strong> specifies a regex match. The example below looks for the string "string" followed by any characters.
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">field</span><span class="p">]</span><span class="w"> </span><span class="o">=~</span><span class="w"> </span><span class="s2">&quot;string*&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">do_something</span><span class="p">...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="condition-checks-against-a-fields-existance">Condition checks against a field's existance</h4>
<p>If you want to apply a configuration but only if a field exists use this:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">field</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">do_something</span><span class="p">...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>The syntax <strong>if [field] {</strong> means only run if the field <strong>field</strong> exists.</p>
<h4 id="handling-multiple-conditions">Handling multiple conditions</h4>
<p>Sometimes you need to apply multiple logical conditions. To do this use <strong>and</strong> and <strong>or</strong>. For example, the below configuration requires a specific string for <strong>field1</strong> and an integer over 5 for <strong>field2</strong>.
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">field1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="p">[</span><span class="nx">field2</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">5</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">do_something</span><span class="p">...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This is a similar example but where <strong>field1</strong> needs to be set to string <strong>or</strong> <strong>field2</strong> needs to be over 5.</p>
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">field1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="p">[</span><span class="nx">field2</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">5</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">do_something</span><span class="p">...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="input-plugins">Input Plugins</h2>
<ul>
<li><a href="#beats">beats</a></li>
<li><a href="#elasticsearch">elasticsearch</a></li>
<li><a href="#file">file</a></li>
<li><a href="#jdbc">jdbc</a></li>
<li><a href="#tcp">tcp</a></li>
<li><a href="#udp">udp</a></li>
<li><a href="#rabbitmq">rabbitmq</a></li>
<li><a href="#kafka">kafka</a></li>
</ul>
<p>Special considerations (not actual plugins)</p>
<ul>
<li><a href="#codecs">codecs</a></li>
</ul>
<hr />
<h3 id="beats">beats</h3>
<p>The <strong>beats</strong> plugin is an input plugin used to accept logs from beats agents such as winlogbeat and filebeat.</p>
<p>This example shows how to listen for logs from beats on port 5044. You cannot change the type when using beats.
<div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">beats</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mf">5044</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<hr />
<h3 id="elasticsearch">elasticsearch</h3>
<p>The <strong>elasticsearch</strong> input plugin is an input plugin used to accept logs from an elasticsearch index. This can be used to re-import logs from an existing index. It requires a query to be specified.</p>
<div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">elasticsearch</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">hosts</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;localhost&quot;</span>
<span class="w">        </span><span class="nx">query</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s1">&#39;{ &quot;query&quot;: { &quot;match&quot;: { &quot;statuscode&quot;: 200 } }, &quot;sort&quot;: [ &quot;_doc&quot; ] }&#39;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h3 id="jdbc">jdbc</h3>
<p>The <strong>jdbc</strong> plugin is an input plugin used to retrieve logs from a database such as Microsoft SQL or MySQL. It is often used to retrieve logs from third party systems that store logs in a database such as McAfee ePO (endpoint protection suite).</p>
<h2 id="input-jdbc-jdbc_driver_library-etclogstashdriverssqljdbc42jar-jdbc_driver_class-commicrosoftsqlserverjdbcsqlserverdriver-jdbc_connection_string-jdbcsqlserversqlserver_name_goes_here1433databasenamedatabase_name_goes_here-jdbc_fetch_size-10000-jdbc_user-sql_user_goes_here-jdbc_password-sql_password_goes_here-schedule-statement-select-idipv4usermesesage-from-logs-tracking_column-id-type-mssql"><div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">jdbc</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">jdbc_driver_library</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;/etc/logstash/drivers/sqljdbc42.jar&quot;</span>
<span class="w">        </span><span class="nx">jdbc_driver_class</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;com.microsoft.sqlserver.jdbc.SQLServerDriver&quot;</span>
<span class="w">        </span><span class="nx">jdbc_connection_string</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;jdbc:sqlserver://sqlserver_name_goes_here:1433;databasename=database_name_goes_here&quot;</span>
<span class="w">        </span><span class="nx">jdbc_fetch_size</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;10000&quot;</span>
<span class="w">        </span><span class="nx">jdbc_user</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;sql_user_goes_here&quot;</span>
<span class="w">        </span><span class="nx">jdbc_password</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;sql_password_goes_here&quot;</span>
<span class="w">        </span><span class="nx">schedule</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;* * * * *&quot;</span>
<span class="w">        </span><span class="nx">statement</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;SELECT id,ipv4,user,mesesage FROM logs&quot;</span>
<span class="w">        </span><span class="nx">tracking_column</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">id</span>
<span class="w">        </span><span class="nx">type</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;mssql&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></h2>
<h3 id="file">file</h3>
<p>The <strong>file</strong> plugin is an input plugin used to monitor files or folders.</p>
<p>Input configuration for monitoring a file:
<div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">file</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">path</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;/var/log/syslog&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
Input configuration for monitoring a folder:
<div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">file</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">path</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;/var/log/&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
Input configuration for monitoring CSV files within a folder:
<div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">file</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">path</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;/path/to/some/folder/*.csv&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<hr />
<h3 id="tcp">tcp</h3>
<p>The <strong>tcp</strong> input plugin is an input plugin that listens on a TCP port for logs.</p>
<p>Input configuration for accepting logs on TCP port 1025:
<div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">tcp</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mf">1025</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
It is recommended to add either a tag or type or both to all inputs. These should be used to specify the expected logs and/or information about these logs such as method of collection. This example shows both:
<div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">tcp</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mf">1025</span>
<span class="w">        </span><span class="nx">type</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;name_goes_here&quot;</span>
<span class="w">        </span><span class="nx">tags</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;name_goes_here&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
On Linux operating systems you must have be root or have administrative privileges to listen on ports 1024 and below. However, running Logstash as root is a bad idea. One way around this is to use iptables. The iptables command below maps port 514 (syslog) to port 1514.
<div class="highlight"><pre><span></span><code>iptables<span class="w"> </span>-t<span class="w"> </span>nat<span class="w"> </span>-A<span class="w"> </span>PREROUTING<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">514</span><span class="w"> </span>-j<span class="w"> </span>REDIRECT<span class="w"> </span>--to-port<span class="w"> </span><span class="m">1514</span>
</code></pre></div>
The equivalent Logstash configuration file that accepts these logs is below:
<div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">tcp</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mf">1514</span>
<span class="w">        </span><span class="nx">type</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;syslog&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
To make iptables persist across reboots you can use iptables-save and iptables-restore. For more information on this see this link:
https://help.ubuntu.com/community/IptablesHowTo#Using_iptables-save.2Frestore_to_test_rules</p>
<h3 id="udp">udp</h3>
<p>The <strong>udp</strong> input plugin is an input plugin that listens on a UDP port for logs.</p>
<p>Input configuration for accepting logs on UDP port 1025:
<div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">udp</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mf">1025</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
It is recommended to add either a tag or type or both to all inputs. These should be used to specify the expected logs and/or information about these logs such as method of collection. This example shows both:
<div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">udp</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mf">1025</span>
<span class="w">        </span><span class="nx">type</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;name_goes_here&quot;</span>
<span class="w">        </span><span class="nx">tags</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;name_goes_here&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
On Linux operating systems you must have be root or have administrative privileges to listen on ports 1024 and below. However, running Logstash as root is a bad idea. One way around this is to use iptables. The iptables command below maps port 514 (syslog) to port 1514.
<div class="highlight"><pre><span></span><code>iptables<span class="w"> </span>-t<span class="w"> </span>nat<span class="w"> </span>-A<span class="w"> </span>PREROUTING<span class="w"> </span>-p<span class="w"> </span>udp<span class="w"> </span>--dport<span class="w"> </span><span class="m">514</span><span class="w"> </span>-j<span class="w"> </span>REDIRECT<span class="w"> </span>--to-port<span class="w"> </span><span class="m">1514</span>
</code></pre></div>
The equivalent Logstash configuration file that accepts these logs is below:
<div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">udp</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mf">1514</span>
<span class="w">        </span><span class="nx">type</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;syslog&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
To make iptables persist across reboots you can use iptables-save and iptables-restore. For more information on this see this link:
https://help.ubuntu.com/community/IptablesHowTo#Using_iptables-save.2Frestore_to_test_rules</p>
<h3 id="rabbitmq">rabbitmq</h3>
<p>The <strong>rabbitmq</strong> input plugin is an input plugin that retrieves logs stored in RabbitMQ, which is a common third party message broker/log buffer.</p>
<p>This example shows the basic rabbitmq settings needed by Logstash:
<div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">rabbitmq</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">key</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;logstashkey&quot;</span>
<span class="w">    </span><span class="nx">queue</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;logstashqueue&quot;</span>
<span class="w">    </span><span class="nx">durable</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="nx">exchange</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;logstashexchange&quot;</span>
<span class="w">    </span><span class="nx">user</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;logstash&quot;</span>
<span class="w">    </span><span class="nx">password</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;password_goes_here&quot;</span>
<span class="w">    </span><span class="nx">host</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;rabbitmq_server_goes_here&quot;</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mf">5672</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This example below shows the basic RabbitMQ settings needed by Logstash but also includes some tags for troubleshooting. It assumes that it is pulling Windows logs out of a queue for Windows. The tags help troubleshoot issues related to a specific queue.
<div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">rabbitmq</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">key</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;logstashkey&quot;</span>
<span class="w">    </span><span class="nx">queue</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;windows&quot;</span>
<span class="w">    </span><span class="nx">durable</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="nx">exchange</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;logstashexchange&quot;</span>
<span class="w">    </span><span class="nx">user</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;logstash&quot;</span>
<span class="w">    </span><span class="nx">password</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;password_goes_here&quot;</span>
<span class="w">    </span><span class="nx">host</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;rabbitmq_server_goes_here&quot;</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mf">5672</span>
<span class="w">    </span><span class="nx">tags</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;queue_windows&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;rabbitmq&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<h3 id="kafka">kafka</h3>
<p>The <strong>kafka</strong> input plugin is an input plugin that retrieves logs stored in Kafka, which is a common third party message broker/log buffer.</p>
<p>This example shows the basic kafka settings needed by Logstash:
<div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">kafka</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">zk_connect</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;kafka_server_goes_here:2181&quot;</span>
<span class="w">    </span><span class="nx">topic_id</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;logstash&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This example below shows the basic Kakfa settings needed by Logstash but also includes some tags for troubleshooting. It assumes that it is pulling Windows logs out of a queue for Windows. The tags help troubleshoot issues related to a specific queue.
<div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">kafka</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">zk_connect</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;kafka_server_goes_here:2181&quot;</span>
<span class="w">    </span><span class="nx">topic_id</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;windows&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">    </span><span class="nx">tags</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;queue_windows&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;kafka&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<hr />
<h3 id="codecs">codecs</h3>
<p>Codecs can be used in input plugins to tell Logstash what data representation to expect in incoming logs. For example, if you know that logs coming in to the <strong>tcp</strong> plugin are going to be json you could use this:</p>
<div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">tcp</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;6000&quot;</span>
<span class="w">        </span><span class="nx">codec</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;json&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The above configuration would automatically extract json field data similar to the below configuration. The difference is the below configuration must first shove the log into a field called <strong>message</strong> and then extract the json information from it.</p>
<div class="highlight"><pre><span></span><code><span class="nx">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">tcp</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;6000&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">json</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">source</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;message&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="filter-parsing-plugins">Filter Parsing Plugins</h2>
<ul>
<li><a href="#csv">csv</a></li>
<li><a href="#date">date</a></li>
<li><a href="#grok">grok</a></li>
<li><a href="#json">json</a></li>
<li><a href="#kv">kv</a></li>
</ul>
<!-- - [xml](#xml) -->

<hr />
<h3 id="csv">csv</h3>
<p>The <strong>csv</strong> plugin is an filter plugin used to parse out fields that are seperated by a specific character.</p>
<p>The below example configuration retrieves specific columns that are tab delimited from a Bro DHCP log
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">csv</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">columns</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span><span class="s2">&quot;uid&quot;</span><span class="p">,</span><span class="s2">&quot;source_ip&quot;</span><span class="p">,</span><span class="s2">&quot;source_port&quot;</span><span class="p">,</span><span class="s2">&quot;destination_ip&quot;</span><span class="p">,</span><span class="s2">&quot;destination_port&quot;</span><span class="p">,</span><span class="s2">&quot;protocol&quot;</span><span class="p">,</span><span class="s2">&quot;transaction_id&quot;</span><span class="p">,</span><span class="s2">&quot;rtt&quot;</span><span class="p">,</span><span class="s2">&quot;query&quot;</span><span class="p">,</span><span class="s2">&quot;query_class&quot;</span><span class="p">,</span><span class="s2">&quot;query_class_name&quot;</span><span class="p">,</span><span class="s2">&quot;query_type&quot;</span><span class="p">,</span><span class="s2">&quot;query_type_name&quot;</span><span class="p">,</span><span class="s2">&quot;rcode&quot;</span><span class="p">,</span><span class="s2">&quot;rcode_name&quot;</span><span class="p">,</span><span class="s2">&quot;aa&quot;</span><span class="p">,</span><span class="s2">&quot;tc&quot;</span><span class="p">,</span><span class="s2">&quot;rd&quot;</span><span class="p">,</span><span class="s2">&quot;ra&quot;</span><span class="p">,</span><span class="s2">&quot;z&quot;</span><span class="p">,</span><span class="s2">&quot;answers&quot;</span><span class="p">,</span><span class="s2">&quot;ttls&quot;</span><span class="p">,</span><span class="s2">&quot;rejected&quot;</span><span class="p">]</span>
<span class="w">      </span><span class="nx">separator</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;    &quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<hr />
<h3 id="date">date</h3>
<p>The <strong>date</strong> plugin is an filter plugin used to parse and normalize the date from a given field.</p>
<p>Date uses the match parameter to set patterns to parse out timestamps. The match parameter takes an array of one or more patterns. For more information see: https://www.elastic.co/guide/en/logstash/current/plugins-filters-date.html#plugins-filters-date-match</p>
<p>The below example configuration attempts to match a syslog time format against a field called syslog_timestamp.
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">date</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">match</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;syslog_timestamp&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;MMM  d HH:mm:ss&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;MMM dd HH:mm:ss&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>The below example configuration attempts to match a syslog time format against a field called syslog_timestamp and includes a timezone.
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">date</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">match</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;syslog_timestamp&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;MMM  d HH:mm:ss&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;MMM dd HH:mm:ss&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">      </span><span class="nx">timezone</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;America/Chicago&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>The below example configuration attempts to match a timestamp based on the traditional year-month-day hour:minute:second format such as 2017-07-06 04:30:00.
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">date</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">match</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;EventTime&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;YYYY-MM-dd HH:mm:ss&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>The below example configuration attempts to match a timestamp based on the traditional UNIX timestamp format format such as 1496031788.649121 (taken from Bro log).
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">date</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">match</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;UNIX&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>The below example configuration attempts to match a timestamp based ISO8601 format which is 2017-07-06T04:30:00.100Z.
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">date</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">match</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;EventTime&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ISO8601&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>When using the date plugin, it may make sense to remove the original date field after it has been converted successfully. This can be done by adding remove_field such as below.
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">date</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">match</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;EventTime&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ISO8601&quot;</span><span class="p">]</span>
<span class="w">      </span><span class="nx">remove_field</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;EventTime&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<hr />
<h3 id="grok">grok</h3>
<p>The <strong>grok</strong> plugin is an filter plugin used to parse fields using patterns and regex.</p>
<p>Grok allows both raw regex and grok patterns (which are really regex anyway) to be used in any combination. It is an extremely powerful tool.</p>
<p>When building out grok parsers it may make sense to do so using the website Grok Debugger:</p>
<p>https://grokdebug.herokuapp.com/</p>
<p>Patterns are simple to apply.</p>
<p>Take this sentence:
<strong>The dog is brown and 4 years old.</strong></p>
<p>This would be the way to parse out the type of animal, color, and age using patterns:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">grok</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">match</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;message&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;The %{WORD:animal} is %{WORD:color} and %{INT:age} years old.&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This would be the way to parse out the type of animal, color, and age using regex:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">grok</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">match</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;message&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;The (?&lt;animal&gt;[a-zA-Z]+) is (?&lt;color&gt;[a-zA-Z]+) and (?&lt;age&gt;[0-9]+) years old.&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Please keep in mind that sometimes special characters will need escaped with "\". For example, consider this message:</p>
<p>There are [10] items in storage.</p>
<p>This grok configuration would fail:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">grok</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">match</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;message&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;There are [%{INT:number}] items in storage.&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This would be the correct configuration that escapes the [ and ] characters:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">grok</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">match</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;message&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;There are \[%{INT:number}\] items in storage.&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Now, what if a log sometimes has extra fields and other times does not? This would cause the pattern/regex match to fail. The way around this is to either perform multiple grok matches or handle optional fields.</p>
<p>Consider you need grok to be able to parse both of these sentences:</p>
<p><strong>The dog is brown and 4 years old.</strong>
<strong>The dog is brown and 4 years old and is owned by George.</strong></p>
<h4 id="multiple-grok-match"><strong>Multiple grok match</strong></h4>
<p>Multiple grok matches simply need multiple match statements. The order of operations matters. The first match stops grok unless the parameter break_on_match is set to FALSE.</p>
<p>This is an example of a grok configuration that can parse both the sentences above using multiple grok match statements:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">grok</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">match</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;message&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;The %{WORD:animal} is %{WORD:color} and %{INT:age} years old and is owned by %{WORD:owner}.&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="nx">match</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;message&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;The %{WORD:animal} is %{WORD:color} and %{INT:age} years old.&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="handling-optional-fields"><strong>Handling optional fields</strong></h4>
<p>It is not uncommon for logs to have optional fields that sometimes exist and other times do not. To handle this with grok you can simply specific something as optional by surrounding it in ()?.</p>
<p>This is an example of a grok configuration that can parse both sentences above by adding an optional field reference using ()? in the configuration:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">grok</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">match</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;message&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;The (?&lt;animal&gt;[a-zA-Z]+) is (?&lt;color&gt;[a-zA-Z]+) and (?&lt;age&gt;[0-9]+) years old( and is owned by %{WORD:owner})?.&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Here is an example of grok being used against a Linux auth.log event:</p>
<div class="highlight"><pre><span></span><code>&lt;<span class="m">11</span>&gt;Jun<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">22</span>:45:01<span class="w"> </span>sec-555-linux<span class="w"> </span>CRON<span class="o">[</span><span class="m">2385</span><span class="o">]</span>:<span class="w"> </span>pam_unix<span class="o">(</span>cron:session<span class="o">)</span>:<span class="w"> </span>session<span class="w"> </span>closed<span class="w"> </span><span class="k">for</span><span class="w"> </span>user<span class="w"> </span>root
</code></pre></div>
<p>The below example configuration attempts to parse the log above with grok patterns.
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">grok</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">match</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;message&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;&lt;%{INT:syslog_pri}&gt;%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\[%{POSINT:syslog_pid}\])?: %{GREEDYDATA:syslog_message}&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This is an example of looking for base64 text in a Windows PowerShell event ID 4104:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">event_id</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">4104</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="p">[</span><span class="nx">ScriptBlockText</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="p">[</span><span class="nx">source_name</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;Microsoft-Windows-PowerShell&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">grok</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">match</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;ScriptBlockText&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;(?&lt;possible_base64_code&gt;[A-Za-z0-9+/]{50,}[=]{0,2})&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">            </span><span class="nx">tag_on_failure</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Setting tag_on_failure to [] tells grok to not add a tag of _grokparsefailure if it fails to find a match.</p>
<p>Common Grok Patterns are below:</p>
<div class="highlight"><pre><span></span><code>USERNAME<span class="w"> </span><span class="o">[</span>a-zA-Z0-9._-<span class="o">]</span>+
USER<span class="w"> </span>%<span class="o">{</span>USERNAME<span class="o">}</span>
INT<span class="w"> </span><span class="o">(</span>?:<span class="o">[</span>+-<span class="o">]</span>?<span class="o">(</span>?:<span class="o">[</span><span class="m">0</span>-9<span class="o">]</span>+<span class="o">))</span>
BASE10NUM<span class="w"> </span><span class="o">(</span>?&lt;!<span class="o">[</span><span class="m">0</span>-9.+-<span class="o">])(</span>?&gt;<span class="o">[</span>+-<span class="o">]</span>?<span class="o">(</span>?:<span class="o">(</span>?:<span class="o">[</span><span class="m">0</span>-9<span class="o">]</span>+<span class="o">(</span>?:<span class="se">\.</span><span class="o">[</span><span class="m">0</span>-9<span class="o">]</span>+<span class="o">)</span>?<span class="o">)</span><span class="p">|</span><span class="o">(</span>?:<span class="se">\.</span><span class="o">[</span><span class="m">0</span>-9<span class="o">]</span>+<span class="o">)))</span>
NUMBER<span class="w"> </span><span class="o">(</span>?:%<span class="o">{</span>BASE10NUM<span class="o">})</span>
BASE16NUM<span class="w"> </span><span class="o">(</span>?&lt;!<span class="o">[</span><span class="m">0</span>-9A-Fa-f<span class="o">])(</span>?:<span class="o">[</span>+-<span class="o">]</span>?<span class="o">(</span>?:0x<span class="o">)</span>?<span class="o">(</span>?:<span class="o">[</span><span class="m">0</span>-9A-Fa-f<span class="o">]</span>+<span class="o">))</span>
BASE16FLOAT<span class="w"> </span><span class="se">\b</span><span class="o">(</span>?&lt;!<span class="o">[</span><span class="m">0</span>-9A-Fa-f.<span class="o">])(</span>?:<span class="o">[</span>+-<span class="o">]</span>?<span class="o">(</span>?:0x<span class="o">)</span>?<span class="o">(</span>?:<span class="o">(</span>?:<span class="o">[</span><span class="m">0</span>-9A-Fa-f<span class="o">]</span>+<span class="o">(</span>?:<span class="se">\.</span><span class="o">[</span><span class="m">0</span>-9A-Fa-f<span class="o">]</span>*<span class="o">)</span>?<span class="o">)</span><span class="p">|</span><span class="o">(</span>?:<span class="se">\.</span><span class="o">[</span><span class="m">0</span>-9A-Fa-f<span class="o">]</span>+<span class="o">)))</span><span class="se">\b</span>

POSINT<span class="w"> </span><span class="se">\b</span><span class="o">(</span>?:<span class="o">[</span><span class="m">1</span>-9<span class="o">][</span><span class="m">0</span>-9<span class="o">]</span>*<span class="o">)</span><span class="se">\b</span>
NONNEGINT<span class="w"> </span><span class="se">\b</span><span class="o">(</span>?:<span class="o">[</span><span class="m">0</span>-9<span class="o">]</span>+<span class="o">)</span><span class="se">\b</span>
WORD<span class="w"> </span><span class="se">\b\w</span>+<span class="se">\b</span>
NOTSPACE<span class="w"> </span><span class="se">\S</span>+
SPACE<span class="w"> </span><span class="se">\s</span>*
DATA<span class="w"> </span>.*?
GREEDYDATA<span class="w"> </span>.*
QUOTEDSTRING<span class="w"> </span><span class="o">(</span>?&gt;<span class="o">(</span>?&lt;!<span class="se">\\</span><span class="o">)(</span>?&gt;<span class="s2">&quot;(?&gt;\\.|[^\\&quot;</span><span class="o">]</span>+<span class="o">)</span>+<span class="s2">&quot;|&quot;&quot;|(?&gt;&#39;(?&gt;\\.|[^\\&#39;]+)+&#39;)|&#39;&#39;|(?&gt;`(?&gt;\\.|[^\\`]+)+`)|``))</span>
<span class="s2">UUID [A-Fa-f0-9]{8}-(?:[A-Fa-f0-9]{4}-){3}[A-Fa-f0-9]{12}</span>

<span class="s2"># Networking</span>
<span class="s2">MAC (?:%{CISCOMAC}|%{WINDOWSMAC}|%{COMMONMAC})</span>
<span class="s2">CISCOMAC (?:(?:[A-Fa-f0-9]{4}\.){2}[A-Fa-f0-9]{4})</span>
<span class="s2">WINDOWSMAC (?:(?:[A-Fa-f0-9]{2}-){5}[A-Fa-f0-9]{2})</span>
<span class="s2">COMMONMAC (?:(?:[A-Fa-f0-9]{2}:){5}[A-Fa-f0-9]{2})</span>
<span class="s2">IPV6 ((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?</span>
<span class="s2">IPV4 (?&lt;![0-9])(?:(?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2}))(?![0-9])</span>
<span class="s2">IP (?:%{IPV6}|%{IPV4})</span>
<span class="s2">HOSTNAME \b(?:[0-9A-Za-z][0-9A-Za-z-]{0,62})(?:\.(?:[0-9A-Za-z][0-9A-Za-z-]{0,62}))*(\.?|\b)</span>
<span class="s2">HOST %{HOSTNAME}</span>
<span class="s2">IPORHOST (?:%{HOSTNAME}|%{IP})</span>
<span class="s2">HOSTPORT (?:%{IPORHOST=~/\./}:%{POSINT})</span>

<span class="s2"># paths</span>
<span class="s2">PATH (?:%{UNIXPATH}|%{WINPATH})</span>
<span class="s2">UNIXPATH (?&gt;/(?&gt;[\w_%!</span><span class="nv">$@</span><span class="s2">:.,-]+|\\.)*)+</span>
<span class="s2">TTY (?:/dev/(pts|tty([pq])?)(\w+)?/?(?:[0-9]+))</span>
<span class="s2">WINPATH (?&gt;[A-Za-z]+:|\\)(?:\\[^\\?*]*)+</span>
<span class="s2">URIPROTO [A-Za-z]+(\+[A-Za-z+]+)?</span>
<span class="s2">URIHOST %{IPORHOST}(?::%{POSINT:port})?</span>
<span class="s2"># uripath comes loosely from RFC1738, but mostly from what Firefox</span>
<span class="s2"># doesn&#39;t turn into %XX</span>
<span class="s2">URIPATH (?:/[A-Za-z0-9</span>$<span class="s2">.+!*&#39;(){},~:;=@#%_\-]*)+</span>
<span class="s2">#URIPARAM \?(?:[A-Za-z0-9]+(?:=(?:[^&amp;]*))?(?:&amp;(?:[A-Za-z0-9]+(?:=(?:[^&amp;]*))?)?)*)?</span>
<span class="s2">URIPARAM \?[A-Za-z0-9</span>$<span class="s2">.+!*&#39;|(){},~@#%&amp;/=:;_?\-\[\]]*</span>
<span class="s2">URIPATHPARAM %{URIPATH}(?:%{URIPARAM})?</span>
<span class="s2">URI %{URIPROTO}://(?:%{USER}(?::[^@]*)?@)?(?:%{URIHOST})?(?:%{URIPATHPARAM})?</span>

<span class="s2"># Months: January, Feb, 3, 03, 12, December</span>
<span class="s2">MONTH \b(?:Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sep(?:tember)?|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?)\b</span>
<span class="s2">MONTHNUM (?:0?[1-9]|1[0-2])</span>
<span class="s2">MONTHDAY (?:(?:0[1-9])|(?:[12][0-9])|(?:3[01])|[1-9])</span>

<span class="s2"># Days: Monday, Tue, Thu, etc...</span>
<span class="s2">DAY (?:Mon(?:day)?|Tue(?:sday)?|Wed(?:nesday)?|Thu(?:rsday)?|Fri(?:day)?|Sat(?:urday)?|Sun(?:day)?)</span>

<span class="s2"># Years?</span>
<span class="s2">YEAR (?&gt;\d\d){1,2}</span>
<span class="s2">HOUR (?:2[0123]|[01]?[0-9])</span>
<span class="s2">MINUTE (?:[0-5][0-9])</span>
<span class="s2"># &#39;60&#39; is a leap second in most time standards and thus is valid.</span>
<span class="s2">SECOND (?:(?:[0-5][0-9]|60)(?:[:.,][0-9]+)?)</span>
<span class="s2">TIME (?!&lt;[0-9])%{HOUR}:%{MINUTE}(?::%{SECOND})(?![0-9])</span>
<span class="s2"># datestamp is YYYY/MM/DD-HH:MM:SS.UUUU (or something like it)</span>
<span class="s2">DATE_US %{MONTHNUM}[/-]%{MONTHDAY}[/-]%{YEAR}</span>
<span class="s2">DATE_EU %{MONTHDAY}[./-]%{MONTHNUM}[./-]%{YEAR}</span>
<span class="s2">ISO8601_TIMEZONE (?:Z|[+-]%{HOUR}(?::?%{MINUTE}))</span>
<span class="s2">ISO8601_SECOND (?:%{SECOND}|60)</span>
<span class="s2">TIMESTAMP_ISO8601 %{YEAR}-%{MONTHNUM}-%{MONTHDAY}[T ]%{HOUR}:?%{MINUTE}(?::?%{SECOND})?%{ISO8601_TIMEZONE}?</span>
<span class="s2">DATE %{DATE_US}|%{DATE_EU}</span>
<span class="s2">DATESTAMP %{DATE}[- ]%{TIME}</span>
<span class="s2">TZ (?:[PMCE][SD]T|UTC)</span>
<span class="s2">DATESTAMP_RFC822 %{DAY} %{MONTH} %{MONTHDAY} %{YEAR} %{TIME} %{TZ}</span>
<span class="s2">DATESTAMP_OTHER %{DAY} %{MONTH} %{MONTHDAY} %{TIME} %{TZ} %{YEAR}</span>

<span class="s2"># Syslog Dates: Month Day HH:MM:SS</span>
<span class="s2">SYSLOGTIMESTAMP %{MONTH} +%{MONTHDAY} %{TIME}</span>
<span class="s2">PROG (?:[\w._/%-]+)</span>
<span class="s2">SYSLOGPROG %{PROG:program}(?:\[%{POSINT:pid}\])?</span>
<span class="s2">SYSLOGHOST %{IPORHOST}</span>
<span class="s2">SYSLOGFACILITY &lt;%{NONNEGINT:facility}.%{NONNEGINT:priority}&gt;</span>
<span class="s2">HTTPDATE %{MONTHDAY}/%{MONTH}/%{YEAR}:%{TIME} %{INT}</span>

<span class="s2"># Shortcuts</span>
<span class="s2">QS %{QUOTEDSTRING}</span>

<span class="s2"># Log formats</span>
<span class="s2">SYSLOGBASE %{SYSLOGTIMESTAMP:timestamp} (?:%{SYSLOGFACILITY} )?%{SYSLOGHOST:logsource} %{SYSLOGPROG}:</span>
<span class="s2">COMMONAPACHELOG %{IPORHOST:clientip} %{USER:ident} %{USER:auth} \[%{HTTPDATE:timestamp}\] &quot;</span><span class="o">(</span>?:%<span class="o">{</span>WORD:verb<span class="o">}</span><span class="w"> </span>%<span class="o">{</span>NOTSPACE:request<span class="o">}(</span>?:<span class="w"> </span>HTTP/%<span class="o">{</span>NUMBER:httpversion<span class="o">})</span>?<span class="p">|</span>%<span class="o">{</span>DATA:rawrequest<span class="o">})</span><span class="s2">&quot; %{NUMBER:response} (?:%{NUMBER:bytes}|-)</span>
<span class="s2">COMBINEDAPACHELOG %{COMMONAPACHELOG} %{QS:referrer} %{QS:agent}</span>

<span class="s2"># Log Levels</span>
<span class="s2">LOGLEVEL ([A-a]lert|ALERT|[T|t]race|TRACE|[D|d]ebug|DEBUG|[N|n]otice|NOTICE|[I|i]nfo|INFO|[W|w]arn?(?:ing)?|WARN?(?:ING)?|[E|e]rr?(?:or)?|ERR?(?:OR)?|[C|c]rit?(?:ical)?|CRIT?(?:ICAL)?|[F|f]atal|FATAL|[S|s]evere|SEVERE|EMERG(?:ENCY)?|[Ee]merg(?:ency)?)</span>
</code></pre></div>
<hr />
<h3 id="json">json</h3>
<p>The <strong>json</strong> plugin is an filter plugin used to automatically extract fields from a json log.</p>
<p>This is an example of a JSON log:
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="s2">&quot;Hostname&quot;</span><span class="o">:</span><span class="s2">&quot;nessus01.sec555.com&quot;</span><span class="p">,</span><span class="s2">&quot;Keywords&quot;</span><span class="o">:-</span><span class="mf">9223372036854775808</span><span class="p">,</span><span class="s2">&quot;Severity&quot;</span><span class="o">:</span><span class="s2">&quot;INFO&quot;</span><span class="p">,</span><span class="s2">&quot;ProviderGuid&quot;</span><span class="o">:</span><span class="s2">&quot;{C2E6D0D9-5DF8-4C77-A82B-C96C84579543}&quot;</span><span class="p">,</span><span class="s2">&quot;Version&quot;</span><span class="o">:</span><span class="mf">0</span><span class="p">,</span><span class="s2">&quot;Task&quot;</span><span class="o">:</span><span class="mf">1</span><span class="p">,</span><span class="s2">&quot;Domain&quot;</span><span class="o">:</span><span class="s2">&quot;NT AUTHORITY&quot;</span><span class="p">,</span><span class="s2">&quot;Message&quot;</span><span class="o">:</span><span class="s2">&quot;Unloading the management provider&quot;</span><span class="p">,</span><span class="s2">&quot;Opcode&quot;</span><span class="o">:</span><span class="s2">&quot;Stop&quot;</span><span class="p">,</span><span class="s2">&quot;EventData&quot;</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;@version&quot;</span><span class="o">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="s2">&quot;@timestamp&quot;</span><span class="o">:</span><span class="s2">&quot;2017-05-27T02:27:51.000Z&quot;</span><span class="p">,</span><span class="s2">&quot;host&quot;</span><span class="o">:</span><span class="s2">&quot;172.16.0.2&quot;</span><span class="p">,</span><span class="s2">&quot;port&quot;</span><span class="o">:</span><span class="mf">54451</span><span class="p">,</span><span class="s2">&quot;type&quot;</span><span class="o">:</span><span class="s2">&quot;windows&quot;</span><span class="p">,</span><span class="s2">&quot;tags&quot;</span><span class="o">:</span><span class="p">[],</span><span class="s2">&quot;user&quot;</span><span class="o">:</span><span class="s2">&quot;Network Service&quot;</span><span class="p">,</span><span class="s2">&quot;account_type&quot;</span><span class="o">:</span><span class="s2">&quot;Well Known Group&quot;</span><span class="p">,</span><span class="s2">&quot;category&quot;</span><span class="o">:</span><span class="s2">&quot;Provider initialization&quot;</span><span class="p">,</span><span class="s2">&quot;channel&quot;</span><span class="o">:</span><span class="s2">&quot;Microsoft-Windows-ServerManager-MgmtProvider/Operational&quot;</span><span class="p">,</span><span class="s2">&quot;event_id&quot;</span><span class="o">:</span><span class="mf">2</span><span class="p">,</span><span class="s2">&quot;event_received_time&quot;</span><span class="o">:</span><span class="mf">1495852073</span><span class="p">,</span><span class="s2">&quot;event_type&quot;</span><span class="o">:</span><span class="s2">&quot;INFO&quot;</span><span class="p">,</span><span class="s2">&quot;opcode_value&quot;</span><span class="o">:</span><span class="mf">2</span><span class="p">,</span><span class="s2">&quot;process_id&quot;</span><span class="o">:</span><span class="mf">2396</span><span class="p">,</span><span class="s2">&quot;record_number&quot;</span><span class="o">:</span><span class="mf">2605</span><span class="p">,</span><span class="s2">&quot;severity_value&quot;</span><span class="o">:</span><span class="mf">2</span><span class="p">,</span><span class="s2">&quot;source_module_name&quot;</span><span class="o">:</span><span class="s2">&quot;eventlog&quot;</span><span class="p">,</span><span class="s2">&quot;source_module_type&quot;</span><span class="o">:</span><span class="s2">&quot;im_msvistalog&quot;</span><span class="p">,</span><span class="s2">&quot;source_name&quot;</span><span class="o">:</span><span class="s2">&quot;Microsoft-Windows-ServerManager-ManagementProvider&quot;</span><span class="p">,</span><span class="s2">&quot;thread_id&quot;</span><span class="o">:</span><span class="mf">4468</span><span class="p">,</span><span class="s2">&quot;logstash_time&quot;</span><span class="o">:</span><span class="mf">0.0</span><span class="p">}</span>
</code></pre></div>
Notice that it is surrounded by { } and contains "field":"value". JSON can also handle nested fields such as:</p>
<p><div class="highlight"><pre><span></span><code><span class="p">{</span><span class="s2">&quot;Name&quot;</span><span class="o">:</span><span class="s2">&quot;Justin Henderson&quot;</span><span class="p">,</span>
<span class="s2">&quot;Email&quot;</span><span class="o">:</span><span class="s2">&quot;justin@hasecuritysolutions.com&quot;</span><span class="p">,</span>
<span class="s2">&quot;Attributes&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;EyeColor&quot;</span><span class="o">:</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;Height&quot;</span><span class="o">:</span><span class="s2">&quot;average&quot;</span>
<span class="p">}}</span>
</code></pre></div>
JSON is extremely easy to parse because you do not really parse it. You simply use the json plugin to automatically extract all the fields including nested ones.</p>
<p>The default source field is message. You only need to specific the source field if it is not message. Here is an example configuration that will automatic extract fields from the message field using json:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">json</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Here is an example configuration that will automatic extract fields from the event field using json:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">json</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">source</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;event&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<hr />
<h3 id="kv">kv</h3>
<p>The <strong>kv</strong> plugin is an filter plugin used to automatically extract fields from a key value based log.</p>
<p>Key value means data is stored using a field name, some kind of separator character, and the field value.</p>
<p>Example of key value data separated by = (default and most common)
<div class="highlight"><pre><span></span><code><span class="nv">source_ip</span><span class="o">=</span><span class="m">192</span>.168.0.1<span class="w"> </span><span class="nv">source_port</span><span class="o">=</span><span class="m">50000</span><span class="w"> </span><span class="nv">destination_ip</span><span class="o">=</span><span class="m">8</span>.8.8.8<span class="w"> </span><span class="nv">destination_port</span><span class="o">=</span><span class="m">53</span>
</code></pre></div></p>
<p>This is an example of a real kv log:
<div class="highlight"><pre><span></span><code>&lt;<span class="m">189</span>&gt;date<span class="o">=</span><span class="m">2017</span>-04-23<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="m">21</span>:21:46<span class="w"> </span><span class="nv">devname</span><span class="o">=</span>FGT50E3U16006093<span class="w"> </span><span class="nv">devid</span><span class="o">=</span>FGT50E3U16006093<span class="w"> </span><span class="nv">logid</span><span class="o">=</span><span class="m">0001000014</span><span class="w"> </span><span class="nv">type</span><span class="o">=</span>traffic<span class="w"> </span><span class="nv">subtype</span><span class="o">=</span><span class="nb">local</span><span class="w"> </span><span class="nv">level</span><span class="o">=</span>notice<span class="w"> </span><span class="nv">vd</span><span class="o">=</span>root<span class="w"> </span><span class="nv">srcip</span><span class="o">=</span><span class="m">192</span>.168.254.2<span class="w"> </span><span class="nv">srcport</span><span class="o">=</span><span class="m">123</span><span class="w"> </span><span class="nv">srcintf</span><span class="o">=</span>root<span class="w"> </span><span class="nv">dstip</span><span class="o">=</span><span class="m">208</span>.91.112.51<span class="w"> </span><span class="nv">dstport</span><span class="o">=</span><span class="m">123</span><span class="w"> </span><span class="nv">dstintf</span><span class="o">=</span>wan1<span class="w"> </span><span class="nv">sessionid</span><span class="o">=</span><span class="m">16237216</span><span class="w"> </span><span class="nv">proto</span><span class="o">=</span><span class="m">17</span><span class="w"> </span><span class="nv">action</span><span class="o">=</span>accept<span class="w"> </span><span class="nv">policyid</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">dstcountry</span><span class="o">=</span>Canada<span class="w"> </span><span class="nv">srccountry</span><span class="o">=</span>Reserved<span class="w"> </span><span class="nv">trandisp</span><span class="o">=</span>noop<span class="w"> </span><span class="nv">service</span><span class="o">=</span>NTP<span class="w"> </span><span class="nv">app</span><span class="o">=</span>NTP<span class="w"> </span><span class="nv">duration</span><span class="o">=</span><span class="m">181</span><span class="w"> </span><span class="nv">sentbyte</span><span class="o">=</span><span class="m">76</span><span class="w"> </span><span class="nv">rcvdbyte</span><span class="o">=</span><span class="m">76</span><span class="w"> </span><span class="nv">sentpkt</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">rcvdpkt</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">appcat</span><span class="o">=</span>unscannedroot
</code></pre></div></p>
<p>The configuration below uses kv to automatically extract fields and their corresponding values:</p>
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">grok</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">match</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;message&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\[%{POSINT:syslog_pid}\])?: %{GREEDYDATA:syslog_message}&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">kv</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">source</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;syslog_message&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The above configuration first uses grok to parse out the traditional syslog fields. It stores the syslog message into a field called syslog_message and then uses kv against it. This means kv was ran only against this:</p>
<div class="highlight"><pre><span></span><code><span class="nv">devname</span><span class="o">=</span>FGT50E3U16006093<span class="w"> </span><span class="nv">devid</span><span class="o">=</span>FGT50E3U16006093<span class="w"> </span><span class="nv">logid</span><span class="o">=</span><span class="m">0001000014</span><span class="w"> </span><span class="nv">type</span><span class="o">=</span>traffic<span class="w"> </span><span class="nv">subtype</span><span class="o">=</span><span class="nb">local</span><span class="w"> </span><span class="nv">level</span><span class="o">=</span>notice<span class="w"> </span><span class="nv">vd</span><span class="o">=</span>root<span class="w"> </span><span class="nv">srcip</span><span class="o">=</span><span class="m">192</span>.168.254.2<span class="w"> </span><span class="nv">srcport</span><span class="o">=</span><span class="m">123</span><span class="w"> </span><span class="nv">srcintf</span><span class="o">=</span>root<span class="w"> </span><span class="nv">dstip</span><span class="o">=</span><span class="m">208</span>.91.112.51<span class="w"> </span><span class="nv">dstport</span><span class="o">=</span><span class="m">123</span><span class="w"> </span><span class="nv">dstintf</span><span class="o">=</span>wan1<span class="w"> </span><span class="nv">sessionid</span><span class="o">=</span><span class="m">16237216</span><span class="w"> </span><span class="nv">proto</span><span class="o">=</span><span class="m">17</span><span class="w"> </span><span class="nv">action</span><span class="o">=</span>accept<span class="w"> </span><span class="nv">policyid</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">dstcountry</span><span class="o">=</span>Canada<span class="w"> </span><span class="nv">srccountry</span><span class="o">=</span>Reserved<span class="w"> </span><span class="nv">trandisp</span><span class="o">=</span>noop<span class="w"> </span><span class="nv">service</span><span class="o">=</span>NTP<span class="w"> </span><span class="nv">app</span><span class="o">=</span>NTP<span class="w"> </span><span class="nv">duration</span><span class="o">=</span><span class="m">181</span><span class="w"> </span><span class="nv">sentbyte</span><span class="o">=</span><span class="m">76</span><span class="w"> </span><span class="nv">rcvdbyte</span><span class="o">=</span><span class="m">76</span><span class="w"> </span><span class="nv">sentpkt</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">rcvdpkt</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">appcat</span><span class="o">=</span>unscannedroot
</code></pre></div>
<p>Sometimes a log will come over with an empty value. In order for kv to work, the value portion cannot be empty.</p>
<p>For example, this is acceptable:
<div class="highlight"><pre><span></span><code>source_ip:192.168.0.1<span class="w"> </span><span class="nv">vd</span><span class="o">=</span>root<span class="w"> </span><span class="nv">destination_ip</span><span class="o">=</span><span class="m">8</span>.8.8.8
</code></pre></div></p>
<p>This is not:
<div class="highlight"><pre><span></span><code><span class="nv">source_ip</span><span class="o">=</span><span class="m">192</span>.168.0.1<span class="w"> </span><span class="nv">vd</span><span class="o">=</span><span class="w"> </span><span class="nv">destination_ip</span><span class="o">=</span><span class="m">8</span>.8.8.8
</code></pre></div></p>
<p>One way to handle this is to perform a string replacement of empty values and change the value from nothing to something like na (for not applicable). Here is an example on how to do this:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">gsub</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;syslog_message&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;= &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;=na &quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">kv</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">source</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;syslog_message&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>The above configuration will take this syslog_message:
<div class="highlight"><pre><span></span><code><span class="nv">source_ip</span><span class="o">=</span><span class="m">192</span>.168.0.1<span class="w"> </span><span class="nv">vd</span><span class="o">=</span><span class="w"> </span><span class="nv">destination_ip</span><span class="o">=</span><span class="m">8</span>.8.8.8
</code></pre></div></p>
<p>Then it will convert it into this:
<div class="highlight"><pre><span></span><code><span class="nv">source_ip</span><span class="o">=</span><span class="m">192</span>.168.0.1<span class="w"> </span><span class="nv">vd</span><span class="o">=</span>na<span class="w"> </span><span class="nv">destination_ip</span><span class="o">=</span><span class="m">8</span>.8.8.8
</code></pre></div></p>
<p>Finally, it will use kv to automatically extract the following fields and values:</p>
<p><strong>source_ip</strong>:192.168.0.1
<strong>vd</strong>:"na"
<strong>destination_ip</strong>:8.8.8.8</p>
<h2 id="filter-enrichment-plugins">Filter Enrichment Plugins</h2>
<ul>
<li><a href="#dns">dns</a></li>
<li><a href="#drop">drop</a></li>
<li><a href="#filter_elasticsearch">elasticsearch</a></li>
<li><a href="#memoize">memoize</a></li>
<li><a href="#geoip">geoip</a></li>
</ul>
<!-- - [jdbc_streaming](#jdbc_streaming) -->
<ul>
<li><a href="#mutate">mutate</a></li>
<li><a href="#rest">rest</a></li>
<li><a href="#ruby">ruby</a></li>
<li><a href="#syslog_pri">syslog_pri</a></li>
<li><a href="#tld">tld</a></li>
<li><a href="#translate">translate</a></li>
</ul>
<hr />
<h3 id="dns">dns</h3>
<p>The <strong>dns</strong> plugin is a filter plugin used to either resolve a name to an IP address or an IP address to a name.</p>
<p>This example takes a domain and resolves it to an IP address:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">dns</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">resolve</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;hostname&quot;</span>
<span class="w">        </span><span class="nx">action</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;replace&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This example takes an IP address and resolves it to a name:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">dns</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">reverse</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;source_ip&quot;</span>
<span class="w">        </span><span class="nx">action</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;replace&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Both of the examples above would overwrite the fields specific (hostname and source_ip) with the value of the DNS answer. This is <strong>not</strong> the expected behavior. To get around this, add a field that clones the value of the original field and use the dns plugin against it.</p>
<p>Here is an example that first takes the value of the field hostname and puts it into a new field called hostname_resolved. Then it takes the hostname_resolved field and resolves it to an IP address:</p>
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">add_field</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;hostname_resolved&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;%{hostname}&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">dns</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">resolve</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;hostname_resolved&quot;</span>
<span class="w">        </span><span class="nx">action</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;replace&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Here is an example that first takes the value of the field source_ip and puts it into a new field called source_ip_resolved. Then it takes the source_ip_resolved field and resolves it to a domain name:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">add_field</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;source_ip_resolved&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;%{source_ip}&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">dns</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">reverse</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;source_ip_resolved&quot;</span>
<span class="w">        </span><span class="nx">action</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;replace&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<hr />
<h3 id="drop">drop</h3>
<p>The <strong>drop</strong> plugin is a filter plugin used to remove an event. A dropped event is immediately removed from Logstash and not processed.</p>
<p>The *<em>drop</em> plugin is extremely important. Use it to eliminate events that have little to no value.</p>
<p>This example drops an event if the field syslog_message has the phrase "unknown exception has occurred":
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">syslog_message</span><span class="p">]</span><span class="w"> </span><span class="o">=~</span><span class="w"> </span><span class="s2">&quot;unknown exception has occurred&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">drop</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This example drops an event if the EventID field is set to 555:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">EventID</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">555</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">drop</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<hr />
<h3 id="filter_elasticsearch">filter_elasticsearch</h3>
<p>The <strong>elasticsearch</strong> plugin is community filter plugin used to query Elasticsearch. If a match is found, whatever fields are specified will be appended to the existing log.</p>
<p>If lookups are likely to happen multiple times for the same piece of data consider using this plugin in conjunction to #memoize. It will enable caching of the results and allow Logstash to perform much faster lookups.</p>
<p>Consider this scenario, an IDS alert has been received but the alert only contains the source_ip and destination_ip. However, having the DNS name associated with these IP addresses could be valuable to an analyst. If DNS queries and answers are in Elasticsearch, they can be pulled into the IDS alert automatically.</p>
<p>Here is the configuration to do it that works with Logstash versions 5.x/6.x:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">event_type</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;alert&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">elasticsearch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">query</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;highest_registered_domain:%{highest_registered_domain}&quot;</span>
<span class="w">            </span><span class="nx">index</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;alexa-top1m&quot;</span>
<span class="w">            </span><span class="nx">fields</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="s2">&quot;rank&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;rank&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Here is the configuration to do it that works with Logstash version 2.x:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">event_type</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;alert&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">elasticsearch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">hosts</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;localhost&quot;</span><span class="p">]</span>
<span class="w">            </span><span class="nx">index</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;logstash-suricata-dns-*&quot;</span>
<span class="w">            </span><span class="nx">query</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;event_type:dns AND query_type:answer AND response_data:%{[destination_ip]}&quot;</span>
<span class="w">            </span><span class="nx">fields</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[[</span><span class="s2">&quot;query_name&quot;</span><span class="p">,</span><span class="s2">&quot;query&quot;</span><span class="p">],[</span><span class="s2">&quot;dns_id&quot;</span><span class="p">,</span><span class="s2">&quot;dns_id&quot;</span><span class="p">]]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This configuration would take the destination_ip and check to see if the Elasticsearch index logstash-suricata-dns-* had a previous answer that contained the destination_ip. If a match was found the elasticsearch filter plugin would pull back the query_name and dns_id fields. In this example, the query_name field would be stored into a field called query and the dns_id field would be stored into a field called dns_id.</p>
<hr />
<h3 id="memoize">memoize</h3>
<p>The <strong>logstash-filter-memoize</strong> plugin is community filter plugin used to enable caching for other filter plugins. It is used to wrap itself around another filter plugin and cache the results based on a specific field. Subsequent calls to the same filter plugin with the same field value causes memoize to pull the return value from cache rather than running the filter plugin again. This can <strong>drastically</strong> increase performance assuming caching is acceptable per your use case.</p>
<p>Consider this scenario, an IDS alert has been received but the alert only contains the source_ip and destination_ip. However, having the DNS name associated with these IP addresses could be valuable to an analyst. If DNS queries and answers are in Elasticsearch, they can be pulled into the IDS alert automatically.</p>
<p>Here is the configuration to do it:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">event_type</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;alert&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">memoize</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">key</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;%{destination_ip}&quot;</span>
<span class="w">            </span><span class="nx">fields</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;highest_registered_domain&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;query&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">            </span><span class="nx">filter_name</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;elasticsearch&quot;</span>
<span class="w">            </span><span class="nx">filter_options</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">query</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;type:bro_dns AND answers:%{destination_ip}&quot;</span>
<span class="w">                </span><span class="nx">index</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;logstash-bro-*&quot;</span>
<span class="w">                </span><span class="nx">fields</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="s2">&quot;query&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;destination_fqdn&quot;</span>
<span class="w">                    </span><span class="s2">&quot;highest_registered_domain&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;destination_highest_registered_domain&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This configuration would take the destination_ip and check to see if the Elasticsearch index logstash-bro-* had a previous answer that contained the destination_ip. If a match was found the elasticsearch filter plugin would pull back the highest_registered_domain and query fields. In this example, the query field would be stored into a field called destination_fqdn and the highest_registered_domain field would be stored into a field called destination_highest_registered_domain. Memoize would then cache this so that if the same alert came in 50 times the first alert would be cached and the remaining 49 would pull from that chace.</p>
<h4 id="other-use-cases-for-the-memoize-filter-plugin">Other use cases for the memoize filter plugin:</h4>
<ul>
<li>Querying threat intelligence feeds stored in Elasticsearch indexes (<strong>Collective Intelligence Framework</strong> uses Elasticsearch)</li>
<li>Building your own custom intelligence feeds and querying them</li>
<li>Querying custom whitelist information (in house controlled whitelisting feeds can be extremely powerful)</li>
</ul>
<p>There are other ways to do the above but this is another method often overlooked.</p>
<hr />
<h3 id="geoip">geoip</h3>
<p>The <strong>geoip</strong> plugin is a filter plugin used to take an IP address and resolve it to geographic information such as city, state, latitude, longitude, and Autonomous System Number (ASN).</p>
<p>Here is an example of using geoip against a field called destination_ip:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">geoip</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">source</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;[destination_ip]&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Here is an example of using geoip against a field called destination_ip and saving the results to a field called destination_geo:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">geoip</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">source</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;[destination_ip]&quot;</span>
<span class="w">      </span><span class="nx">target</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;destination_geo&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Here is an example of using geoip against a field called destination_ip using a custom geoip database (such as commercial use of MaxMind):
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">geoip</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">database</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;/usr/local/share/GeoIP/GeoLiteCity.dat&quot;</span>
<span class="w">      </span><span class="nx">source</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;[destination_ip]&quot;</span>
<span class="w">      </span><span class="nx">target</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;destination_geo&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>The above examples only retrieve traditional geo information such as city, state, latitude, and longitude. It does not include ASN which is one of the most underutilized and tactically important fields.</p>
<p>The below information shows the standard geoip information for 8.8.8.8:</p>
<div class="highlight"><pre><span></span><code>destination_ip<span class="w">                      </span><span class="m">8</span>.8.8.8
destination_geo.area_code<span class="w">           </span><span class="m">650</span>
destination_geo.city_name<span class="w">           </span>Mountain<span class="w"> </span>View
destination_geo.continent_code<span class="w">      </span>NA
destination_geo.country_code2<span class="w">       </span>US
destination_geo.country_code3<span class="w">       </span>USA
destination_geo.country_name<span class="w">        </span>United<span class="w"> </span>States
destination_geo.ip<span class="w">                  </span><span class="m">8</span>.8.8.8
destination_geo.latitude<span class="w">            </span><span class="m">37</span>.386
destination_geo.location<span class="w">            </span>-122.084,<span class="w"> </span><span class="m">37</span>.386
destination_geo.longitude<span class="w">           </span>-122.084
destination_geo.postal_code<span class="w">         </span><span class="m">94035</span>
destination_geo.real_region_name<span class="w">    </span>California
destination_geo.region_name<span class="w">         </span>CA
destination_geo.timezone<span class="w">            </span>America/Los_Angeles
</code></pre></div>
<p>While this is helpful, it is does not add enough context for the analyst. However, the ASN does. See the ASN information for 8.8.8.8:</p>
<div class="highlight"><pre><span></span><code>destination_ip<span class="w">                      </span><span class="m">8</span>.8.8.8
destination_geo.asn<span class="w">                 </span>Google<span class="w"> </span>Inc.
destination_geo.number<span class="w">              </span>AS15169
</code></pre></div>
<p>Without using DNS, this ASN of 15169 shows that 8.8.8.8 is registered to Google Inc. This is powerful for filtering and applying additional Logstash configurations. For example, you could use the ASN to filter out certain businesses such as Microsoft from specific hunting techniques.</p>
<p>Below is the configuration used to pull in ASN information:</p>
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">geoip</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">database</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;/usr/local/share/GeoIP/GeoIPASNum.dat&quot;</span>
<span class="w">        </span><span class="nx">source</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;[source_ip]&quot;</span>
<span class="w">        </span><span class="nx">target</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;source_geo&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>It simply requires pointing at a ASN database file.</p>
<hr />
<h3 id="mutate">mutate</h3>
<p>The <strong>mutate</strong> plugin is a filter plugin used to alter a log. It has many purposes as seen below.</p>
<h4 id="add-a-field">Add a field</h4>
<p>This example config adds a field called hostname_resolved and starts it with an empty value:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">add_field</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;hostname_resolved&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This example config adds a field called hostname_resolved and clones the value of the hostname field into it:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">add_field</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;hostname_resolved&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;%{hostname}&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="add-a-tag">Add a tag</h4>
<p>This example config adds a tag called pci:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">add_tag</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;pci&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This example config adds a tag called pci and critical_asset:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">add_tag</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;pci&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;critical_asset&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="convert-a-field-type-integer-float-string-boolean">Convert a field type (integer, float, string, boolean)</h4>
<p>This example config converts the field source_port to a integer:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">convert</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;source_port&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="string-replacement-gsub">String Replacement (gsub)</h4>
<p>This example config replaces "= " with "=na " in the syslog_message field:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">gsub</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;syslog_message&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;= &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;=na &quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="add-unique-id">Add unique ID</h4>
<p>This example config adds a unique ID to a log into a field called unique_id:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">id</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;unique_id&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="lowercase-all-text">lowercase all text</h4>
<p>This example config lowercases all letters in the syslog_message field:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">lowercase</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;syslog_message&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="remove-unwantedredundant-fields">Remove unwanted/redundant field(s)</h4>
<p>This example config removes the syslog_message field:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">remove_field</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;syslog_message&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="remove-tags">Remove tag(s)</h4>
<p>This example config removes the alert tag:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">remove_tag</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;alert&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="rename-standardize-field-names">Rename / Standardize field name(s)</h4>
<p>This example config renames the src_ip field to source_ip:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">rename</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;src_ip&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;source_ip&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>Standardizing field names is CRITICAL</strong></p>
<h4 id="replace-a-fields-value">Replace a field's value</h4>
<p>This example config replaces the value of host to 172.16.0.2:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">replace</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;host&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;172.16.0.2&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="remove-whitespace-from-beginning-and-end-of-field">Remove whitespace from beginning and end of field</h4>
<p>This example config removes whitespace from the beginning and end of the syslog_message field:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">strip</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;syslog_message&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="uppercase-all-text">uppercase all text</h4>
<p>This example config uppercase all letters in the syslog_message field:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">uppercase</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;syslog_message&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<hr />
<h3 id="rest">rest</h3>
<p>The <strong>rest</strong> plugin is a community filter plugin used to submit a web based REST request. It is used to query APIs or websites using data from a log. This plugin can be very powerful when used properly.</p>
<h4 id="recommended-use-cases">Recommended use cases:</h4>
<ul>
<li>Entropy (randomness checking) of key fields in conjunction with freq_server.py</li>
<li>DNS top 1 million checking in conjunction with domain_stats.py</li>
<li>WHOIS creation date lookups in conjunction with domain_stats.py</li>
</ul>
<p>This example configuration is used get the entropy score of a DNS domain using the highest_registered_domain field's value (requires freq_server.py listening on 10004):
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">rest</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">request</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">url</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;http://localhost:20001/domain/creation_date/%{highest_registered_domain}&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nx">sprintf</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="nx">json</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="nx">target</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;domain_creation_date&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Another example:</p>
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">rest</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">request</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">url</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;http://localhost:10004/measure/%{highest_registered_domain}&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nx">sprintf</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="nx">json</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="nx">target</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;domain_frequency_score&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">domain_frequency_score</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">convert</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;domain_frequency_score&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;float&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>This example configuration is used to find out the creation date of the highest_registered_domain value (requires domain_stats.py listening on 20000):
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">rest</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">request</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">url</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;http://localhost:20000/alexa/%{highest_registered_domain}&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nx">sprintf</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="nx">json</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="nx">target</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;site&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">site</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="p">[</span><span class="nx">site</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">add_tag</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;top-1m&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">            </span><span class="nx">remove_field</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;site&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This example configuration is used to find out if the highest_registered_domain value is a top 1 million site (requires domain_stats.py listening on 20000):
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">rest</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">request</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">url</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;http://localhost:20000/alexa/%{highest_registered_domain}&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nx">sprintf</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="nx">json</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="nx">target</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;site&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">site</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="p">[</span><span class="nx">site</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">add_tag</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;top-1m&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">            </span><span class="nx">remove_field</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;site&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<hr />
<h3 id="ruby">ruby</h3>
<p>The <strong>ruby</strong> plugin is a filter plugin that allows raw programming logic. It allows invoking ruby to programmatically interact with fields and field data.</p>
<h4 id="recommended-use-cases_1">Recommended use cases:</h4>
<ul>
<li>Calculate field length</li>
<li>Perform mathmatic calculations</li>
<li>Calculate how long Logstash takes to do something</li>
</ul>
<p>This example configuration is used to calculate the field length of a field called certificate_common_name and to store it in a field called certificate_common_name_length:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ruby</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">code</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;event[&#39;certificate_common_name_length&#39;] = event[&#39;certificate_common_name&#39;].length;&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This example configuration is used to calculate the number of days a certificate is valid by substracting the certificate_not_valid_after field from the certificate_not_valid_before field and then rounding the valid to an integer:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ruby</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">code</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;event[&#39;certificate_number_days_valid&#39;] = ((event[&#39;certificate_not_valid_after&#39;] - event[&#39;certificate_not_valid_before&#39;]) / 86400).ceil;&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This example decodes a base64 value stored in a field called possible_base64_code:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ruby</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">init</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;require &#39;base64&#39;&quot;</span>
<span class="w">        </span><span class="nx">code</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;a = Base64.decode64(event[&#39;possible_base64_code&#39;]);</span>
<span class="s2">                 event[&#39;base64_decoded&#39;] = a;&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This example extracts every instance of PowerShell cmdlets being used in EventID 4103 by using scan:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">Payload</span><span class="p">]</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="p">[</span><span class="nx">EventID</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">4103</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="p">[</span><span class="nx">SourceName</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;Microsoft-Windows-PowerShell&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">ruby</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">code</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;event[&#39;cmdlets&#39;] = event[&#39;Payload&#39;].downcase.scan(/commandinvocation\(([a-z0-9-]+)\)/)&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This example configuration is used to calculate how long it takes Logstash to process something:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ruby</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">code</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;event[&#39;task_start&#39;] = Time.now.to_f;&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">Then</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nx">something</span><span class="p">...</span>
<span class="w">    </span><span class="nx">ruby</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">code</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;event[&#39;task_end&#39;] = Time.now.to_f;&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">ruby</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">code</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;event[&#39;logstash_time&#39;] = event[&#39;task_end&#39;] - event[&#39;task_start&#39;]&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">remove_field</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s1">&#39;task_start&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;task_end&#39;</span><span class="w"> </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>The overhead of calculating logstash_time is nominal. This likely can be left on.</p>
<p>This example configuration is used to calculate the ratio of bytes uploaded vs bytes downloaded using flow data:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ruby</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">code</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;event[&#39;byte_ratio_client&#39;] = event[&#39;bytes_to_client&#39;].to_f / event[&#39;bytes_to_server&#39;].to_f&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">ruby</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">code</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;event[&#39;byte_ratio_server&#39;] = 1 - event[&#39;byte_ratio_client&#39;]&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This example configuration is used to take an IDS alerts SID # and use it to retrieve the IDS rule it belongs to and append that rule to the alert:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">gid</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="p">[</span><span class="nx">sid</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">ruby</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">code</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;sid = event[&#39;sid&#39;]; event[&#39;rule&#39;] = `cat /etc/nsm/rules/*.rules | grep sid:#{sid} | head -n1`;&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<hr />
<h3 id="syslog_pri">syslog_pri</h3>
<p>The <strong>syslog_pri</strong> plugin is a filter plugin used to automatically parse the syslog pri field into severity and priority fields.</p>
<p>This is an example configuration using the default message field:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">syslog_pri</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This is an example configuration using a field called syslog_pri:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">syslog_pri</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">        </span><span class="nx">source</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;syslog_pri&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<hr />
<h3 id="tld">tld</h3>
<p>The <strong>tld</strong> plugin is a filter plugin used to take a DNS name and break it up into corresponding pieces. For example, www.google.com would become:</p>
<p><strong>highest_registered_domain</strong> = google.com
<strong>sub_domain</strong> = www
<strong>parent_domain</strong> = google
<strong>top_level_domain</strong> == com</p>
<p>This is an example configuration of using tld against a field called query:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">tld</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">source</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;query&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">mutate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">rename</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;[tld][domain]&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;highest_registered_domain&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="nx">rename</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;[tld][trd]&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;sub_domain&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="nx">rename</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;[tld][tld]&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;top_level_domain&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="nx">rename</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;[tld][sld]&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;parent_domain&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<hr />
<h3 id="translate">translate</h3>
<p>The <strong>translate</strong> plugin is a filter plugin used to take a field and look up a value based on it in a file or provided array of values.</p>
<p>This is an example configuration that takes the value of destination_port and does a lookup of its value in /lib/dictionaries/iana_services.yaml:
<div class="highlight"><pre><span></span><code><span class="nx">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">translate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">field</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;[destination_port]&quot;</span>
<span class="w">        </span><span class="nx">destination</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;[destination_service]&quot;</span>
<span class="w">        </span><span class="nx">dictionary_path</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;/lib/dictionaries/iana_services.yaml&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This could help take a destination_port of 80 and use it to add a field called destination_service with a value of HTTP.</p>
<h2 id="output-plugins">Output Plugins</h2>
<ul>
<li><a href="#stdout">stdout</a></li>
<li><a href="#output_elasticsearch">elasticsearch</a></li>
<li><a href="#output_file">file</a></li>
<li><a href="#output_rabbitmq">rabbitmq</a></li>
<li><a href="#output_kafka">kafka</a></li>
<li><a href="#output_tcp">tcp</a></li>
<li><a href="#output_udp">udp</a></li>
</ul>
<hr />
<h3 id="stdout">stdout</h3>
<p>The <strong>stdout</strong> plug is an output plugin used to output to the screen. It is useful for troubleshooting or testing.</p>
<p>This example configuration is used to output to the screen with pretty markup. This is the most common way to invoke <strong>stdout</strong> and is probably what you want to use.
<div class="highlight"><pre><span></span><code><span class="nx">output</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">stdout</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">codec</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">rubydebug</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Using the above configuration will display output similar to this:
<div class="highlight"><pre><span></span><code><span class="o">{</span>
<span class="w">             </span><span class="s2">&quot;message&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;2017-07-25T17:49:37.356Z sec-555-linux 1496523628.328546\tCfnUMi23OlkVdjx0Wi\t10.0.1.11\t38938\t10.0.0.10\t53\tudp\t46693\t0.001092\tlogingest.test.int\t1\tC_INTERNET1\tA\t0\tNOERROR\tT\tF\tTT0\t172.16.1.10\t3600.000000\tF&quot;</span>,
<span class="w">            </span><span class="s2">&quot;@version&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;1&quot;</span>,
<span class="w">          </span><span class="s2">&quot;@timestamp&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;2017-07-25T17:50:10.710Z&quot;</span>,
<span class="w">                </span><span class="s2">&quot;host&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;sec-555-linux&quot;</span>,
<span class="w">           </span><span class="s2">&quot;timestamp&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;2017-07-25T17:49:37.356Z sec-555-linux 1496523628.328546&quot;</span>,
<span class="w">                 </span><span class="s2">&quot;uid&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;CfnUMi23OlkVdjx0Wi&quot;</span>,
<span class="w">           </span><span class="s2">&quot;source_ip&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;10.0.1.11&quot;</span>,
<span class="w">         </span><span class="s2">&quot;source_port&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;38938&quot;</span>,
<span class="w">      </span><span class="s2">&quot;destination_ip&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;10.0.0.10&quot;</span>,
<span class="w">    </span><span class="s2">&quot;destination_port&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;53&quot;</span>,
<span class="w">            </span><span class="s2">&quot;protocol&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;udp&quot;</span>,
<span class="w">      </span><span class="s2">&quot;transaction_id&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;46693&quot;</span>,
<span class="w">                 </span><span class="s2">&quot;rtt&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;0.001092&quot;</span>,
<span class="w">               </span><span class="s2">&quot;query&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;logingest.test.int&quot;</span>,
<span class="w">         </span><span class="s2">&quot;query_class&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;1&quot;</span>,
<span class="w">    </span><span class="s2">&quot;query_class_name&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;C_INTERNET1&quot;</span>,
<span class="w">          </span><span class="s2">&quot;query_type&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;A&quot;</span>,
<span class="w">     </span><span class="s2">&quot;query_type_name&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;0&quot;</span>,
<span class="w">               </span><span class="s2">&quot;rcode&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;NOERROR&quot;</span>,
<span class="w">          </span><span class="s2">&quot;rcode_name&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;T&quot;</span>,
<span class="w">                  </span><span class="s2">&quot;aa&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;F&quot;</span>,
<span class="w">                  </span><span class="s2">&quot;tc&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;TT0&quot;</span>,
<span class="w">                  </span><span class="s2">&quot;rd&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;172.16.1.10&quot;</span>,
<span class="w">                  </span><span class="s2">&quot;ra&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;3600.000000&quot;</span>,
<span class="w">                   </span><span class="s2">&quot;z&quot;</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="s2">&quot;F&quot;</span>
<span class="o">}</span>
</code></pre></div></p>
<p>The alternative way to run <strong>stdout</strong> is to just invoke it such as in this configuration:
<div class="highlight"><pre><span></span><code><span class="nx">output</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">stdout</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>However, the output is not user friendly and will look like this:</p>
<div class="highlight"><pre><span></span><code><span class="m">2017</span>-07-25T17:49:37.356Z<span class="w"> </span>sec-555-linux<span class="w"> </span><span class="m">1496523628</span>.328546<span class="w">    </span>CfnUMi23OlkVdjx0Wi<span class="w">  </span><span class="m">10</span>.0.1.11<span class="w">   </span><span class="m">38938</span><span class="w">   </span><span class="m">10</span>.0.0.10<span class="w">   </span><span class="m">53</span><span class="w">  </span>udp<span class="w"> </span><span class="m">46693</span><span class="w">   </span><span class="m">0</span>.001092<span class="w">    </span>logingest.test.int<span class="w">  </span><span class="m">1</span><span class="w">   </span>C_INTERNET1<span class="w"> </span>A<span class="w">   </span><span class="m">0</span><span class="w">   </span>NOERROR<span class="w"> </span>T<span class="w">   </span>F<span class="w">   </span>TT0<span class="w"> </span><span class="m">172</span>.16.1.10<span class="w"> </span><span class="m">3600</span>.000000<span class="w"> </span>F
</code></pre></div>
<h3 id="output_elasticsearch">output_elasticsearch</h3>
<p>The <strong>elasticsearch</strong> plugin is an output plugin used to send logs to an Elasticsearch index.</p>
<p>This example configuration is used to send logs to an index for Windows logs:
<div class="highlight"><pre><span></span><code><span class="nx">output</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">elasticsearch</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">index</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;logstash-windows-%{+YYYY.MM.dd}&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This example configuration shows dynamically routing logs to varies Elasticsearch indexes:
<div class="highlight"><pre><span></span><code><span class="nx">output</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">type</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;windows&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">elasticsearch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">index</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;logstash-windows-%{+YYYY.MM.dd}&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">type</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;alert&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">elasticsearch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">index</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;logstash-alert&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="s2">&quot;syslog&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">[</span><span class="nx">tags</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">elasticsearch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">index</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;logstash-syslog-%{+YYYY.MM.dd}&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<hr />
<h3 id="output_file">output_file</h3>
<p>The <strong>file</strong> output plugin is an output plugin used to send logs to a file.</p>
<p>This example configuration is used to send logs to a file called /home/student/logs.json:
<div class="highlight"><pre><span></span><code><span class="nx">output</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">file</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">path</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;/home/student/logs.json&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>It is possible to output logs to other file formats such as CSV. For CSV, use the <strong>csv</strong> output plugin.</p>
<hr />
<h3 id="output_rabbitmq">output_rabbitmq</h3>
<p>The <strong>rabbitmq</strong> output plugin is an output plugin used to send logs to RabbitMQ which is a third party message broker/log buffer.</p>
<p>This example configuration is used to send logs to an exchange for Windows logs:
<div class="highlight"><pre><span></span><code><span class="nx">output</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">rabbitmq</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">key</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;routing_key_goes_here&quot;</span>
<span class="w">        </span><span class="nx">exchange</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;windows&quot;</span>
<span class="w">        </span><span class="nx">exchange_type</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;direct&quot;</span>
<span class="w">        </span><span class="nx">user</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;user_name_goes_here&quot;</span>
<span class="w">        </span><span class="nx">password</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;password_goes_here&quot;</span>
<span class="w">        </span><span class="nx">host</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;rabbitmq_hostname_goes_here&quot;</span>
<span class="w">        </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mf">5672</span>
<span class="w">        </span><span class="nx">durable</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="nx">persistent</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>It is a good practice to route logs to various queues so that you can monitor and troubleshoot them individually. This is an example of doing so:</p>
<div class="highlight"><pre><span></span><code><span class="nx">output</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">type</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;windows&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">rabbitmq</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">key</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;routing_key_goes_here&quot;</span>
<span class="w">            </span><span class="nx">exchange</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;windows&quot;</span>
<span class="w">            </span><span class="nx">exchange_type</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;direct&quot;</span>
<span class="w">            </span><span class="nx">user</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;user_name_goes_here&quot;</span>
<span class="w">            </span><span class="nx">password</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;password_goes_here&quot;</span>
<span class="w">            </span><span class="nx">host</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;rabbitmq_hostname_goes_here&quot;</span>
<span class="w">            </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mf">5672</span>
<span class="w">            </span><span class="nx">durable</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">true</span>
<span class="w">            </span><span class="nx">persistent</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="s2">&quot;syslog&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="nx">tags</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">rabbitmq</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">key</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;routing_key_goes_here&quot;</span>
<span class="w">            </span><span class="nx">exchange</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;syslog&quot;</span>
<span class="w">            </span><span class="nx">exchange_type</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;direct&quot;</span>
<span class="w">            </span><span class="nx">user</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;user_name_goes_here&quot;</span>
<span class="w">            </span><span class="nx">password</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;password_goes_here&quot;</span>
<span class="w">            </span><span class="nx">host</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;rabbitmq_hostname_goes_here&quot;</span>
<span class="w">            </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mf">5672</span>
<span class="w">            </span><span class="nx">durable</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">true</span>
<span class="w">            </span><span class="nx">persistent</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h3 id="output_kafka">output_kafka</h3>
<p>The <strong>kafka</strong> output plugin is an output plugin used to send logs to Kafka which is a third party message broker/log buffer.</p>
<p>This example configuration is used to send logs to a topic for Windows logs:
<div class="highlight"><pre><span></span><code><span class="nx">output</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">kafka</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">bootstrap_servers</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;kafka_server_name_goes_here:9092&quot;</span>
<span class="w">        </span><span class="nx">topic_id</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;syslog&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>It is a good practice to route logs to various topics so that you can monitor and troubleshoot them individually. This is an example of doing so:</p>
<div class="highlight"><pre><span></span><code><span class="nx">output</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">type</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;windows&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">kafka</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">bootstrap_servers</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;kafka_server_name_goes_here:9092&quot;</span>
<span class="w">            </span><span class="nx">topic_id</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;windows&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="s2">&quot;syslog&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="nx">tags</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">kafka</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">bootstrap_servers</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;kafka_server_name_goes_here:9092&quot;</span>
<span class="w">            </span><span class="nx">topic_id</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;syslog&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<h3 id="output_tcp">output_tcp</h3>
<p>The <strong>tcp</strong> output plugin is an output plugin used to send logs to a remote logging host. It can be used to send logs from Logstash to a commercial SIEM.</p>
<p>This example configuration is used to send logs to a remote host over TCP port 5000
<div class="highlight"><pre><span></span><code><span class="nx">output</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">tcp</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">host</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;dns_name_or_ip_address_goes_here&quot;</span>
<span class="w">        </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mf">5000</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This example configuration is used to send logs with a type of <strong>alert</strong> to a remote host over TCP port 5000
<div class="highlight"><pre><span></span><code><span class="nx">output</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">type</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;alert&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">tcp</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">host</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;dns_name_or_ip_address_goes_here&quot;</span>
<span class="w">            </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mf">5000</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<hr />
<h3 id="output_udp">output_udp</h3>
<p>The <strong>udp</strong> output plugin is an output plugin used to send logs to a remote logging host. It can be used to send logs from Logstash to a commercial SIEM.</p>
<p>This example configuration is used to send logs to a remote host over UDP port 5000
<div class="highlight"><pre><span></span><code><span class="nx">output</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">udp</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">host</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;dns_name_or_ip_address_goes_here&quot;</span>
<span class="w">        </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mf">5000</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>This example configuration is used to send logs with a type of <strong>alert</strong> to a remote host over UDP port 5000
<div class="highlight"><pre><span></span><code><span class="nx">output</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">[</span><span class="nx">type</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;alert&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">udp</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">host</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s2">&quot;dns_name_or_ip_address_goes_here&quot;</span>
<span class="w">            </span><span class="nx">port</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mf">5000</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<h2 id="additional-info">Additional Info</h2>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">February 1, 2025</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">February 1, 2025</span>
  </span>

    
    
    
      
  <span class="md-source-file__fact">
    
      
  <span class="md-icon" title="Contributors">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
  </span>
  <span>GitHub</span>

    
    <nav>
      
        <a href="https://github.com/bkemily" class="md-author" title="@bkemily">
          
          <img src="https://avatars.githubusercontent.com/u/107584119?v=4&size=72" alt="bkemily">
        </a>
      
      
      
    </nav>
  </span>

    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5090c770.min.js"></script>
      
    
  </body>
</html>